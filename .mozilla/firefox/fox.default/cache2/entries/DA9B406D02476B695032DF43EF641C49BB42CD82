 
  function displayTT(pUid) {
    var fieldName = 'p' + pUid;
    var fieldValue = document.getElementById(fieldName).value;  
    //return overlib(fieldValue,CAPTION,'',TEXTFONTCLASS,'OraBGAccentLight',CAPTIONFONTCLASS,'OraCalendarHeader', MOUSEOFF);
    return overlib(fieldValue,CAPTION,'',TEXTFONTCLASS,'OraBGAccentLight',CAPTIONFONTCLASS,'OraCalendarHeader', MOUSEOFF, VAUTO, HAUTO );
  }
 
  function displayRecordSet(pUid) {
    var fieldName = 'p' + pUid;
    var fieldValue = document.getElementById(fieldName).value;  
    return overlib(fieldValue,CAPTION,'',TEXTFONTCLASS,'OraBGAccentLight',CAPTIONFONTCLASS,'OraCalendarHeader', MOUSEOFF, VAUTO, HAUTO , STICKY, OFFSETX, -160);
  }
 
 
 function enableAllFields(form){
        
          var validated = _validateForm(form);
          //alert('validated: ' + validated);
          
          if (validated){
            if (!valCheckBox(form)){ 
           //   alert('Please check, NOT VALIDATED!');
              return false;
            }
          }
          
          if (validated){
          var count = form.elements.length;
 
          for (i=0; i<count; i++){
            var element = form.elements[i];
            //exclude character counter input fields (remLen)
            if(element.disabled == true && element.name.indexOf('remLen') == -1){
                element.disabled = false;
                //alert(element.name + ', disabled = false');
            }
          }
          //alert('true')
          return true;
        }else{
         //alert('false');
         return false; 
        }
    }
    
     function valCheckBox(form){
   
         var count = form.elements.length;
      //   alert('Form Element Count : ' + count);
         
          for (i=0; i<count; i++){
            var element = form.elements[i];
         //    alert('Element Name : ' + element.name);
         //     alert('Element ID : ' + element.id);
         //       alert('Element ShortDesc : ' + element.shortDesc);
         //    alert('Element Type : ' + element.type );
              
            if (element.type == 'checkbox') {
          //   alert('It is Checkbox :' );
               if (element.id.indexOf('yes') >= 0) {
             //     alert('It is Required' );
                  if (element.checked == false) {
                      i = i+1;
                      var hiddenCheckbox = form.elements[i];  
              
                      if (hiddenCheckbox.id == element.name) { 
                        alert('A value must be entered for "' + hiddenCheckbox.value + '".');
                      }
                      else {
                        alert('A value must be entered for the required checkbox.');
                      }
                    
                    return false;
                 }  //  if (element.checked == false) {
              } // if (element.id.indexOf('yes') >= 0) {
            } //   if (element.type == 'checkbox') {
          }  //   for (i=0; i<count; i++){
        return true;
  }
 
 
 function hmcalendarpopup(paramname, dateFormat){ 

    var paramvalue = null; 
    var wincalendar = null; 
    
	var link = '/itas/hmcalendar.jsp?dateformat=' + dateFormat + '&targetfield=' + paramname;
  //alert('dateValue: ' + document.getElementById(paramname).value + 'dateFormat: ' + dateFormat);	
	var dateValue = document.getElementById(paramname).value;
	
    if (dateValue == '') 
        paramvalue = 'null'; 
    else {
        link  = link + '&calendardate=' + dateValue; 
    }
		
	wincalender = window.open(link,'Calendar','width=285,height=290,scrollbars=no,dependent=no,resizable=yes'); 
	
	if (wincalender != null) { 
	
		if (wincalender.opener == null) 
			wincalender.opener = self; 	
		
		}
	
	wincalender.focus(); 
}

//open scheduler popup on resourcePlan.uix
function openSchedulerPopupWithDResources(entryUid, defaultGroup, dedicatedResources, CSI)
{
  var url= 'reassignDay_popup.do?ENTRY_UID='.concat(entryUid);
  url = url + '&RESOURCE_UID=' + defaultGroup + '&D_RESOURCES=' + dedicatedResources + '&CSI=' + CSI;
  //alert(dedicatedResources + "   " + CSI);
  return openWindow(window,url,  
            'reassignPopUpWindow',
            {width:1000, height:800, left:100, top:20, statusbar:1,menubar:0, scrollbars:1, resizable:1},
            true,'dialog', null); 
}

//open scheduler popup on reservation page (calEntry2.do)
function openSchedulerPopup(entryUid, defaultGroup)
{
  var url= 'reassignDay_popup.do?ENTRY_UID='.concat(entryUid);
  url = url + '&RESOURCE_UID=' + defaultGroup;
  //alert(entryUid);
  return openWindow(window,url,  
            'reassignPopUpWindow',
            {width:1000, height:800, left:100, top:20, statusbar:1,menubar:0, scrollbars:1, resizable:1},
            true,'dialog', null); 
}

//open scheduler popup on reservation page (calEntry2.do)
function openSchedulerPopupWithObject(entryUid, defaultGroup, objectUid)
{
  var url= 'reassignDay_popup.do?ENTRY_UID='.concat(entryUid);
  url = url + '&RESOURCE_UID=' + defaultGroup;
  url = url + '&OBJECT_UID=' + objectUid;

  return openWindow(window,url,  
            'reassignPopUpWindow',
            {width:1000, height:800, left:100, top:20, statusbar:1,menubar:0, scrollbars:1, resizable:1},
            true,'dialog', null); 
}


//open Calendar popup window
function openCalPopup(fieldname)
{
  //alert(targetPage);
  var url = 'calGrDay_popup.do?CALFIELD='.concat(fieldname); 
  return openWindow(window,url,  
            'calPopUpWindow',
            {width:1200, height:800, left:50, top:20, statusbar:1,menubar:0, scrollbars:1, resizable:1},
            true,'dialog', null); 
}

function selectShift(wrkHrStart, rId, rName, wrkHrEnd)
{

    var agree = confirm('Start Time: ' + wrkHrStart + ' Assignee: ' + rName + ' End Time: ' + wrkHrEnd);
  
	if (agree == true){
	
		var paramCal = "CALFIELD"; //must always be populated with time
		var calId = document.getElementById(paramCal).value;
		//alert('calId: ' + calId);

		var paramRes = "TARGETFIELD0"; //can be NULL; TARGETFIELD0 must be resource
		var resId = document.getElementById(paramRes).value;
		//alert('resId: ' + resId);  

		var target1 = "TARGETFIELD1"; //can be NULL;
		var target1Id = document.getElementById(target1).value;
		//alert('target1Id: ' + target1Id);

		// get the date field in the parent window
		var calField = opener.document.getElementById(calId);
		calField.value = unescape(wrkHrStart); //set time
	
		if (target1Id.length > 0){ //set resource; parameter4799 --> p4799
			var target1Field = opener.document.getElementById(target1Id);
			//alert('target1Field: ' + target1Field);
			target1Field.value = unescape(wrkHrEnd); //set time
			
		}
  
		if (resId.length > 0){ //set resource; parameter4799 --> p4799
    
			//parameter4799 --> p4799
			var pValue = 'p'+resId.substring(9);
			//alert('pValue: ' + pValue);
    
			//parameter4799 --> pa4799
			var paValue = 'pa'+resId.substring(9);
			//alert('paValue: ' + paValue);    
    
			var resField = opener.document.getElementById(pValue); //
			//alert('object found [pValue]: ' + resField);
			resField.value = unescape(rId);
  
			var resDisplayField = opener.document.getElementById(paValue);
			//alert('object found [paValue]: ' + resDisplayField);
			resDisplayField.value = unescape(rName);
		}	
		
		calField.onchange();		
		
		window.close();	
	} else {
		return false ;
	}	
}	

/* -- populate the date field in opener window, whose id is the value of CALFIELD parameter
 * -- if ADD_UID_THROUGH_POPUP event is defined, also populate target field defined in event (optional) 
 * -- time: must not be NULL
 * -- rId: can be NULL
 * -- rName: can be NULL
 **/
function select(time, rId, rName, wrkHrDuration, referenceTZ)
{
  //getElementByName not working; Use getElementById instead.
  //use hidden field (CALFIELD) to store the value of the param named CALFIELD
    
    var rTZ ='';
    if (referenceTZ.length > 0){
      rTZ = '/'+ referenceTZ;      
    }  
    
    var agree = confirm('Start Time' + rTZ +': ' + time + ' Assignee: ' + rName + ' Duration: ' + wrkHrDuration);
  
	if (agree == true){	
	
		//var D = new Date(getDateFromFormat(time,'dd-MMM-yyyy HH:mm'));
		var D = parseDate(time);
	
		//alert('time(0): ' + formatDate(D,'dd-MMM-yyyy HH:mm'));
		var temp = new Array();
		temp = wrkHrDuration.split(':');

		var hours = temp[0];
		//alert('hours: ' + hours);
		var mins = temp[1];
		//alert('mins: ' + mins);
	
		D.setHours(D.getHours() + (hours * 1)); //String to number
		D.setMinutes(D.getMinutes() + (mins * 1)) //String to number
   
		//alert('time(1): ' + formatDate(D,'dd-MMM-yyyy HH:mm'));	
		var endTime = formatDate(D,getDateFormat(time));  
  
		var paramCal = "CALFIELD"; //must always be populated with time
		var calId = document.getElementById(paramCal).value;
		//alert('calId: ' + calId);

		var paramRes = "TARGETFIELD0"; //can be NULL; TARGETFIELD0 must be resource
		var resId = document.getElementById(paramRes).value;
		// alert('resId/resource: ' + resId);  

		var target1 = "TARGETFIELD1"; //can be NULL;
		var target1Id = document.getElementById(target1).value;
		//alert('target1Id: ' + target1Id);

		// get the date field in the parent window
		var calField = opener.document.getElementById(calId);
		calField.value = unescape(time); //set time		

		if (target1Id.length > 0){ //set Schedule End 
			var target1Field = opener.document.getElementById(target1Id);
			//alert('target1Field: ' + target1Field);
			target1Field.value = unescape(endTime); //set time
      //target1Field.onchange(); //trigger UI events with 'Schedule End' as source field (e.g: prefill 'Schedule Outage End')
		}
  
		if (resId.length > 0){ //set resource; parameter4799 --> p4799
    
			//parameter4799 --> p4799
			var pValue = 'p'+resId.substring(9);
			//alert('pValue: ' + pValue);
    
			//parameter4799 --> pa4799
			var paValue = 'pa'+resId.substring(9);
			//alert('paValue: ' + paValue);    
    
			var resField = opener.document.getElementById(pValue); //
			//alert('object found [pValue]: ' + resField);
			resField.value = unescape(rId);
  
			var resDisplayField = opener.document.getElementById(paValue);
			//alert('object found [paValue]: ' + resDisplayField);
			resDisplayField.value = unescape(rName);
		}	
		
		calField.onchange();
		
		window.close(); 	
	} else {
		return false ;
	}
    
  /**parent.location.reload();**/
}


function openCalPopup2(fieldname)
{
  var url= 'cmDay_popup.do?CALFIELD='.concat(fieldname); 
  return openWindow(window,url,  
            'cmPopUpWindow',
            {width:1000, height:800, left:100, top:20, statusbar:1,menubar:0, scrollbars:1, resizable:1},
            true,'dialog', null); 
}

function openCalPopup3(fieldname,entryId)
{
  //var url= 'reSchedule_popup.do?CALFIELD='.concat(fieldname); 
  var url= 'reSchedule_popup.do?CALFIELD=' + fieldname + '&entryUid=' + entryId;
  return openWindow(window,url,  
            'reSchedulePopUpWindow',
            {width:1000, height:800, left:100, top:20, statusbar:1,menubar:0, scrollbars:1, resizable:1},
            true,'dialog', refreshPage); 
}

function openLovTable(parentParameterUid)
{
  //var url= 'reSchedule_popup.do?CALFIELD='.concat(fieldname); 
  var url= 'lovTable.do?parentParameterUid=' + parentParameterUid;
  return openWindow(window,url,  
            'LovTable',
            {width:1000, height:800, left:100, top:20, statusbar:1,menubar:0, scrollbars:1, resizable:1},
            true,'dialog', refreshPage); 
}


function refreshPage() 
{ 
  _uixspu('form0',0,'refreshAfterSearch','M__Id','ItasRequestDetailsHomeVO13',1,0); 
  /*** var confirmation = confirm ("Are you sure you want to refresh"); 
  if (confirmation == true ) { //submitForm(document.form0,1,{'event':'refreshAfterSearch'}); } ***/ 
}



function cmSelect(time,entryUid)
{
  //getElementByName not working; Use getElementById instead.
  //use hidden field (CALFIELD) to store the value of the param named CALFIELD
  var paramName = "CALFIELD";
  var entryId = opener.document.getElementById("EntryUid");  
  var fieldId = document.getElementById(paramName).value;
  // get the date field in the parent window
  var field = opener.document.getElementById(fieldId);
  field.value = unescape(time);
  entryId.value = unescape(entryUid);
  field.focus();
  window.close(); 
  /**parent.location.reload();**/
}

//open FileUpload popup window
function openFileUpload(dataTypeCode, fileUploadId, noteId)
{
  var url= 'fileUpload.do?dataTypeCode=' + dataTypeCode + '&fileUploadId=' + fileUploadId + '&noteId=' + noteId;
  return openWindow(window,url,  
            'fileUpload',
            {width:500, height:200, left:100, top:20, statusbar:1,menubar:0, scrollbars:1, resizable:1},
            true,'dialog', null); 
}

//open FileUpload popup window
function openDisplayClob(noteUid)
{
  var url= 'displayClob.do?noteUid=' + noteUid;
  return openWindow(window,url,  
            'displayClob',
            {width:1000, height:800, left:100, top:20, statusbar:1,menubar:0, scrollbars:1, resizable:1},
            true,'dialog', null); 
}

//return to eventCreate.do, set values into appropriate fields for attachment component
function returnEventCreate(){
  var url = document.location.href;
  //alert("URL: " + url);
  
  if(url.indexOf("zxcvbm_success") != -1) {
    var _length = url.length;
    //alert(_length);
    var _a = url.indexOf('&pAttF=');
    var _b = url.indexOf('&pFileName=');
    var _c = url.indexOf('&pNField=');
    var _d = url.indexOf('&pNUid=');
    
    //upload file parent id, e.g: uploadfieldId: attachment2698347
    var uploadfieldId = url.substring(_a+7,_b);
    //alert('uploadfieldId: ' + uploadfieldId);
    
    //var uploadField = opener.document.getElementById(uploadfieldId);
    var uploadField = opener.document.forms["form0"].elements[uploadfieldId];

    //set value into upload file parent
    //alert('uploadField: ' + uploadField); //undefined
    uploadField.value = unescape(url.substring(_b+11,_c));
    
    //note uid parent id
    var noteId = url.substring(_c+9,_d);
    //alert('noteId: ' + url.substring(_c+9,_d));
    
    var noteUidField = opener.document.forms["form0"].elements[noteId];
    
    //set value into upload file parent
    //alert('noteUidField: ' + url.substring(_d+7,_length));
    noteUidField.value = unescape(url.substring(_d+7,_length));    
    
    uploadField.focus();
    self.close();
  } else if(getURLParam('msgType') == 'error') {        
      alert(getValidationErrors(getURLParam('msg')));    
  }
}

function getURLParam(strParamName){
  var strReturn = "";
  var strHref = window.location.href;
  if ( strHref.indexOf("?") > -1 ){
    var strQueryString = strHref.substr(strHref.indexOf("?")).toLowerCase();
    var aQueryString = strQueryString.split("&");
    for ( var iParam = 0; iParam < aQueryString.length; iParam++ ){
      if (aQueryString[iParam].indexOf(strParamName.toLowerCase() + "=") > -1 ){
        var aParam = aQueryString[iParam].split("=");
        strReturn = aParam[1];
        break;
      }
    }
  }
  return unescape(strReturn);
}

function getValidationErrors(errors){
  var validationErrors = errors.replace(/,,/g, '\n');
  validationErrors = 'File Upload failed while validating Excel Data due to the following validation errors:\n'.concat(validationErrors);  
  return validationErrors;
}

function textCounter(field, countfield, maxlimit) {
  var agt=navigator.userAgent.toLowerCase();
  var lengthDiff =getLFCRDiff(field.value); // FF from windows only counts line return as one character

  if ( (field.value.length + lengthDiff) > maxlimit) 
  {
    // if too long...trim it!
    field.value = field.value.substring(0, maxlimit - lengthDiff);
  }  
  else
  {
    // otherwise, update 'characters left' counter
    countfield.value = maxlimit - (field.value.length + lengthDiff);
    //alert("input=[" + field.value + "] Final length=" + countfield.value  + " maxLimit="+ maxlimit + " field.value.length="+ field.value.length + " lengthDiff=" + lengthDiff);
  }
}

function msgTextCounter(field, countfield, maxlimit) {
  var agt=navigator.userAgent.toLowerCase();
  var lengthDiff =getLFCRDiff(field.value); // FF from windows only counts line return as one character

  if ( (field.value.length + lengthDiff) > maxlimit) 
  {
    // if too long...trim it!
    field.value = field.value.substring(0, maxlimit - lengthDiff);
    //field.value = 'char. left (max. ' +maxlimit + '): ' + (field.value.substring(0, maxlimit - lengthDiff));
  }  
  else
  {
    // otherwise, update 'characters left' counter
    //countfield.value = maxlimit - (field.value.length + lengthDiff);
    countfield.value = 'char. left (max. ' +maxlimit + '): ' + (maxlimit - (field.value.length + lengthDiff) );
    //alert("input=[" + field.value + "] Final length=" + countfield.value  + " maxLimit="+ maxlimit + " field.value.length="+ field.value.length + " lengthDiff=" + lengthDiff);
  }
}


function getLFCRDiff(textstr)
{
  var agt=navigator.userAgent.toLowerCase();
  var isFFWindows= (agt.indexOf('firefox') > -1) && (agt.indexOf('windows') > -1);

  lfcount = 0;
  crcount = 0;
  countdiff = 0;
  if (isFFWindows)
  {
    for (i=1;i < textstr.length;i++){
      a = textstr.charCodeAt(i);
      if (a == 10){
      lfcount++;
      }
      if (a == 13){
      crcount++;
      }
    }

    if (lfcount != crcount){
      countdiff = lfcount - crcount;
      //alert("CR/LF length diff: " + countdiff);
    }
  };
  
  return countdiff;
}

function checkConstantValue() {  
  
  var fieldName = 'rowConstantText';
  var constantField = document.getElementById(fieldName);  
  //var constantValue = document.getElementById(fieldName);
  var return_value = true;
  
  //alert('constantField: ' + constantField);
  
  if (constantField.value == '' && !constantField.disabled)
  {
    return_value = confirm("Constant Value is empty! Is this correct?");
    //alert(return_value);
    return return_value
  }
	return true;
}

function trimDate(target) {
  target.value = target.value.replace( /^\s+/g, "" );// strip leading
  target.value = target.value.replace( /\s+$/g, "" );// strip trailing
}


// ===================================================================
// Author: Matt Kruse <matt@mattkruse.com>
// WWW: http://www.mattkruse.com/
//
// NOTICE: You may use this code for any purpose, commercial or
// private, without any further permission from the author. You may
// remove this notice from your final code if you wish, however it is
// appreciated by the author if at least my web site address is kept.
//
// You may *NOT* re-distribute this code in any way except through its
// use. That means, you can include it in your product, or your web
// site, or any other form where the code is actually being used. You
// may not put the plain javascript up on your site for download or
// include it in your javascript libraries for download. 
// If you wish to share this code with others, please just point them
// to the URL instead.
// Please DO NOT link directly to my .js files from your site. Copy
// the files to your server and use them there. Thank you.
// ===================================================================

// HISTORY
// ------------------------------------------------------------------
// May 17, 2003: Fixed bug in parseDate() for dates <1970
// March 11, 2003: Added parseDate() function
// March 11, 2003: Added "NNN" formatting option. Doesn't match up
//                 perfectly with SimpleDateFormat formats, but 
//                 backwards-compatability was required.

// ------------------------------------------------------------------
// These functions use the same 'format' strings as the 
// java.text.SimpleDateFormat class, with minor exceptions.
// The format string consists of the following abbreviations:
// 
// Field        | Full Form          | Short Form
// -------------+--------------------+-----------------------
// Year         | yyyy (4 digits)    | yy (2 digits), y (2 or 4 digits)
// Month        | MMM (name or abbr.)| MM (2 digits), M (1 or 2 digits)
//              | NNN (abbr.)        |
// Day of Month | dd (2 digits)      | d (1 or 2 digits)
// Day of Week  | EE (name)          | E (abbr)
// Hour (1-12)  | hh (2 digits)      | h (1 or 2 digits)
// Hour (0-23)  | HH (2 digits)      | H (1 or 2 digits)
// Hour (0-11)  | KK (2 digits)      | K (1 or 2 digits)
// Hour (1-24)  | kk (2 digits)      | k (1 or 2 digits)
// Minute       | mm (2 digits)      | m (1 or 2 digits)
// Second       | ss (2 digits)      | s (1 or 2 digits)
// AM/PM        | a                  |
//
// NOTE THE DIFFERENCE BETWEEN MM and mm! Month=MM, not mm!
// Examples:
//  "MMM d, y" matches: January 01, 2000
//                      Dec 1, 1900
//                      Nov 20, 00
//  "M/d/yy"   matches: 01/20/00
//                      9/2/00
//  "MMM dd, yyyy hh:mm:ssa" matches: "January 01, 2000 12:30:45AM"
// ------------------------------------------------------------------

var MONTH_NAMES=new Array('January','February','March','April','May','June','July','August','September','October','November','December','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec');
var DAY_NAMES=new Array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sun','Mon','Tue','Wed','Thu','Fri','Sat');
function LZ(x) {return(x<0||x>9?"":"0")+x}

// ------------------------------------------------------------------
// isDate ( date_string, format_string )
// Returns true if date string matches format of format string and
// is a valid date. Else returns false.
// It is recommended that you trim whitespace around the value before
// passing it to this function, as whitespace is NOT ignored!
// ------------------------------------------------------------------
function isDate(val,format) {
	var date=getDateFromFormat(val,format);
	if (date==0) { return false; }
	return true;
	}

// -------------------------------------------------------------------
// compareDates(date1,date1format,date2,date2format)
//   Compare two date strings to see which is greater.
//   Returns:
//   1 if date1 is greater than date2
//   0 if date2 is greater than date1 of if they are the same
//  -1 if either of the dates is in an invalid format
// -------------------------------------------------------------------
function compareDates(date1,dateformat1,date2,dateformat2) {
	var d1=getDateFromFormat(date1,dateformat1);
	var d2=getDateFromFormat(date2,dateformat2);
	if (d1==0 || d2==0) {
		return -1;
		}
	else if (d1 > d2) {
		return 1;
		}
	return 0;
	}

// ------------------------------------------------------------------
// formatDate (date_object, format)
// Returns a date in the output format specified.
// The format string uses the same abbreviations as in getDateFromFormat()
// ------------------------------------------------------------------
function formatDate(date,format) {
	format=format+"";
	var result="";
	var i_format=0;
	var c="";
	var token="";
	var y=date.getYear()+"";
	var M=date.getMonth()+1;
	var d=date.getDate();
	var E=date.getDay();
	var H=date.getHours();
	var m=date.getMinutes();
	var s=date.getSeconds();
	var yyyy,yy,MMM,MM,dd,hh,h,mm,ss,ampm,HH,H,KK,K,kk,k;
	// Convert real date parts into formatted versions
	var value=new Object();
	if (y.length < 4) {y=""+(y-0+1900);}
	value["y"]=""+y;
	value["yyyy"]=y;
	value["yy"]=y.substring(2,4);
	value["M"]=M;
	value["MM"]=LZ(M);
	value["MMM"]=MONTH_NAMES[M+11];
	//value["NNN"]=MONTH_NAMES[M+11]; //CB: eliminate NNN format
	value["d"]=d;
	value["dd"]=LZ(d);
	value["E"]=DAY_NAMES[E+7];
	value["EE"]=DAY_NAMES[E];
	value["H"]=H;
	value["HH"]=LZ(H);
	if (H==0){value["h"]=12;}
	else if (H>12){value["h"]=H-12;}
	else {value["h"]=H;}
	value["hh"]=LZ(value["h"]);
	if (H>11){value["K"]=H-12;} else {value["K"]=H;}
	value["k"]=H+1;
	value["KK"]=LZ(value["K"]);
	value["kk"]=LZ(value["k"]);
	if (H > 11) { value["a"]="PM"; }
	else { value["a"]="AM"; }
	value["m"]=m;
	value["mm"]=LZ(m);
	value["s"]=s;
	value["ss"]=LZ(s);
	while (i_format < format.length) {
		c=format.charAt(i_format);
		token="";
		while ((format.charAt(i_format)==c) && (i_format < format.length)) {
			token += format.charAt(i_format++);
			}
		if (value[token] != null) { result=result + value[token]; }
		else { result=result + token; }
		}
	return result;
	}
	
// ------------------------------------------------------------------
// Utility functions for parsing in getDateFromFormat()
// ------------------------------------------------------------------
function _isInteger(val) {
	var digits="1234567890";
	for (var i=0; i < val.length; i++) {
		if (digits.indexOf(val.charAt(i))==-1) { return false; }
		}
	return true;
	}
function _getInt(str,i,minlength,maxlength) {
	for (var x=maxlength; x>=minlength; x--) {
		var token=str.substring(i,i+x);
		if (token.length < minlength) { return null; }
		if (_isInteger(token)) { return token; }
		}
	return null;
	}
	
// ------------------------------------------------------------------
// getDateFromFormat( date_string , format_string )
//
// This function takes a date string and a format string. It matches
// If the date string matches the format string, it returns the 
// getTime() of the date. If it does not match, it returns 0.
// ------------------------------------------------------------------
function getDateFromFormat(val,format) {
	val=val+"";
	format=format+"";
	var i_val=0;
	var i_format=0;
	var c="";
	var token="";
	var token2="";
	var x,y;
	var now=new Date();
	var year=now.getYear();
	var month=now.getMonth()+1;
	var date=1;
	var hh=now.getHours();
	var mm=now.getMinutes();
	var ss=now.getSeconds();
	var ampm="";
	
	while (i_format < format.length) {
		// Get next token from format string
		c=format.charAt(i_format);
		token="";
		while ((format.charAt(i_format)==c) && (i_format < format.length)) {
			token += format.charAt(i_format++);
			}
		// Extract contents of value based on format token
		if (token=="yyyy" || token=="yy" || token=="y") {
			if (token=="yyyy") { x=4;y=4; }
			if (token=="yy")   { x=2;y=2; }
			if (token=="y")    { x=2;y=4; }
			year=_getInt(val,i_val,x,y);
			if (year==null) { return 0; }
			i_val += year.length;
			if (year.length==2) {
				if (year > 70) { year=1900+(year-0); }
				else { year=2000+(year-0); }
				}
			}
		else if (token=="MMM"||token=="NNN"){
			month=0;
			for (var i=0; i<MONTH_NAMES.length; i++) {
				var month_name=MONTH_NAMES[i];
				if (val.substring(i_val,i_val+month_name.length).toLowerCase()==month_name.toLowerCase()) {
					if (token=="MMM"||(token=="NNN"&&i>11)) {
						month=i+1;
						if (month>12) { month -= 12; }
						i_val += month_name.length;
						break;
						}
					}
				}
			if ((month < 1)||(month>12)){return 0;}
			}
		else if (token=="EE"||token=="E"){
			for (var i=0; i<DAY_NAMES.length; i++) {
				var day_name=DAY_NAMES[i];
				if (val.substring(i_val,i_val+day_name.length).toLowerCase()==day_name.toLowerCase()) {
					i_val += day_name.length;
					break;
					}
				}
			}
		else if (token=="MM"||token=="M") {
			month=_getInt(val,i_val,token.length,2);
			if(month==null||(month<1)||(month>12)){return 0;}
			i_val+=month.length;}
		else if (token=="dd"||token=="d") {
			date=_getInt(val,i_val,token.length,2);
			if(date==null||(date<1)||(date>31)){return 0;}
			i_val+=date.length;}
		else if (token=="hh"||token=="h") {
			hh=_getInt(val,i_val,token.length,2);
			if(hh==null||(hh<1)||(hh>12)){return 0;}
			i_val+=hh.length;}
		else if (token=="HH"||token=="H") {
			hh=_getInt(val,i_val,token.length,2);
			if(hh==null||(hh<0)||(hh>23)){return 0;}
			i_val+=hh.length;}
		else if (token=="KK"||token=="K") {
			hh=_getInt(val,i_val,token.length,2);
			if(hh==null||(hh<0)||(hh>11)){return 0;}
			i_val+=hh.length;}
		else if (token=="kk"||token=="k") {
			hh=_getInt(val,i_val,token.length,2);
			if(hh==null||(hh<1)||(hh>24)){return 0;}
			i_val+=hh.length;hh--;}
		else if (token=="mm"||token=="m") {
			mm=_getInt(val,i_val,token.length,2);
			if(mm==null||(mm<0)||(mm>59)){return 0;}
			i_val+=mm.length;}
		else if (token=="ss"||token=="s") {
			ss=_getInt(val,i_val,token.length,2);
			if(ss==null||(ss<0)||(ss>59)){return 0;}
			i_val+=ss.length;}
		else if (token=="a") {
			if (val.substring(i_val,i_val+2).toLowerCase()=="am") {ampm="AM";}
			else if (val.substring(i_val,i_val+2).toLowerCase()=="pm") {ampm="PM";}
			else {return 0;}
			i_val+=2;}
		else {
			if (val.substring(i_val,i_val+token.length)!=token) {return 0;}
			else {i_val+=token.length;}
			}
		}
	// If there are any trailing characters left in the value, it doesn't match
	if (i_val != val.length) { return 0; }
	// Is date valid for month?
	if (month==2) {
		// Check for leap year
		if ( ( (year%4==0)&&(year%100 != 0) ) || (year%400==0) ) { // leap year
			if (date > 29){ return 0; }
			}
		else { if (date > 28) { return 0; } }
		}
	if ((month==4)||(month==6)||(month==9)||(month==11)) {
		if (date > 30) { return 0; }
		}
	// Correct hours value
	if (hh<12 && ampm=="PM") { hh=hh-0+12; }
	else if (hh>11 && ampm=="AM") { hh-=12; }
	var newdate=new Date(year,month-1,date,hh,mm,ss);
	return newdate.getTime();
	}

// ------------------------------------------------------------------
// CB: restrict to certain date formats --> derived from ItasCustomDate
//
//parseDate( date_string [, prefer_euro_format] )
//
// This function takes a date string and tries to match it to a
// number of possible date formats to get the value. It will try to
// match against the following international formats, in this order:
// y-M-d   MMM d, y   MMM d,y   y-MMM-d   d-MMM-y  MMM d
// M/d/y   M-d-y      M.d.y     MMM-d     M/d      M-d
// d/M/y   d-M-y      d.M.y     d-MMM     d/M      d-M
// A second argument may be passed to instruct the method to search
// for formats like d/M/y (european format) before M/d/y (American).
// Returns a Date object or null if no patterns match.
// ------------------------------------------------------------------
function parseDate(val) {
	var preferEuro=(arguments.length==2)?arguments[1]:false;
	//generalFormats=new Array('y-M-d','MMM d, y','MMM d,y','y-MMM-d','d-MMM-y','MMM d');
	//generalFormats=new Array('MM/dd/yyyy HH:mm','MM/dd/yy HH:mm','dd-MMM-yyyy HH:mm','yyyy-MM-dd HH:mm');
	generalFormats=new Array('MM/dd/yyyy HH:mm','MM/dd/yy HH:mm','dd-MMM-yyyy HH:mm','yyyy-MM-dd HH:mm', 'dd-MM-yyyy HH:mm', 'dd-MM-yy HH:mm');
  monthFirst=new Array('M/d/y','M-d-y','M.d.y','MMM-d','M/d','M-d');
	dateFirst =new Array('d/M/y','d-M-y','d.M.y','d-MMM','d/M','d-M');
	var checkList=new Array('generalFormats',preferEuro?'dateFirst':'monthFirst',preferEuro?'monthFirst':'dateFirst');
	//var checkList=new Array('MM/dd/yyyy HH:mm','MM/dd/yy HH:mm','dd-MMM-yyyy HH:mm','yyyy-MM-dd HH:mm');
	var d=null;
	for (var i=0; i<checkList.length; i++) {
		var l=window[checkList[i]];
		for (var j=0; j<l.length; j++) {
			d=getDateFromFormat(val,l[j]);
			if (d!=0) { 
			return new Date(d); }
			}
		}
	return null;
	}

	
function getDateFormat(val) {
	var preferEuro=(arguments.length==2)?arguments[1]:false;
	//generalFormats=new Array('y-M-d','MMM d, y','MMM d,y','y-MMM-d','d-MMM-y','MMM d');
//	generalFormats=new Array('MM/dd/yyyy HH:mm','MM/dd/yy HH:mm','dd-MMM-yyyy HH:mm','yyyy-MM-dd HH:mm');
	generalFormats=new Array('MM/dd/yyyy HH:mm','MM/dd/yy HH:mm','dd-MMM-yyyy HH:mm','yyyy-MM-dd HH:mm', 'dd-MM-yyyy HH:mm', 'dd-MM-yy HH:mm');
  monthFirst=new Array('M/d/y','M-d-y','M.d.y','MMM-d','M/d','M-d');
	dateFirst =new Array('d/M/y','d-M-y','d.M.y','d-MMM','d/M','d-M');
	var checkList=new Array('generalFormats',preferEuro?'dateFirst':'monthFirst',preferEuro?'monthFirst':'dateFirst');
	//var checkList=new Array('MM/dd/yyyy HH:mm','MM/dd/yy HH:mm','dd-MMM-yyyy HH:mm','yyyy-MM-dd HH:mm');
	var d=null;
	for (var i=0; i<checkList.length; i++) {
		var l=window[checkList[i]];
		for (var j=0; j<l.length; j++) {
			d=getDateFromFormat(val,l[j]);
			if (d!=0) { 
			//alert('date format: ' + l[j]);
			return l[j]; }
			}
		}
	return null;
	}	

                function disableButton(buttonID)
                {
                  var validated = _validateForm(document.forms['form0']);
                  if (validated) {
                    var buttonElement = document.getElementById(buttonID);
                    if (buttonElement.disabled) {
//alert('You can click button only once.');
                      return false;
                    } else {
//alert('button is active.');
                      buttonElement.disabled = true;
                      return true;
                    }
                  } else {
                    return false;
                  }
                }         
            
        function doLoad()
        {
            setTimeout( "location.reload(true);", 500*1000 );  // 5 minutes
        }


        
        function show_hide(compnentID)
        {
          state = document.getElementById(compnentID).style.visibility;			
//alert( "Component[" +   compnentID + "] current state = [" + state);
        
          if (state == "hidden") {document.getElementById(compnentID).style.visibility = "visible";}
          if (state == "visible") {document.getElementById(compnentID).style.visibility = "hidden";}
          
          return true;
        }
        
        
        function show(object) {
//alert("Showing [" + object);
        
          //document.getElementById(object).style.display = "none";  // for certain browsers??
          if (document.getElementById) {
            document.getElementById(object).style.visibility = 'visible';
          }
          else if (document.layers && document.layers[object]) {
            document.layers[object].visibility = 'visible';
          }
          else if (document.all) {
            document.all[object].style.visibility = 'visible';
          }
          
          return true;
        }
        
        function hide(object) {
        
//alert("Hiding [" + object);
          //document.getElementById(object).style.display = "block"; // for certain browsers??
          if (document.getElementById) {
            document.getElementById(object).style.visibility = 'hidden';
          }
          else if (document.layers && document.layers[object]) {
            document.layers[object].visibility = 'hidden';
          }
          else if (document.all) {
            document.all[object].style.visibility = 'hidden';
          }
          
          return true;
        }         20181008124021é  ú   (   !       (                         @  uŠ         
     f u n c t i o n   d i s p l a y T T ( p U i d )   {  
         v a r   f i e l d N a m e   =   ' p '   +   p U i d ;  
         v a r   f i e l d V a l u e   =   d o c u m e n t . g e t E l e m e n t B y I d ( f i e l d N a m e ) . v a l u e ;      
         / / r e t u r n   o v e r l i b ( f i e l d V a l u e , C A P T I O N , ' ' , T E X T F O N T C L A S S , ' O r a B G A c c e n t L i g h t ' , C A P T I O N F O N T C L A S S , ' O r a C a l e n d a r H e a d e r ' ,   M O U S E O F F ) ;  
         r e t u r n   o v e r l i b ( f i e l d V a l u e , C A P T I O N , ' ' , T E X T F O N T C L A S S , ' O r a B G A c c e n t L i g h t ' , C A P T I O N F O N T C L A S S , ' O r a C a l e n d a r H e a d e r ' ,   M O U S E O F F ,   V A U T O ,   H A U T O   ) ;  
     }  
    
     f u n c t i o n   d i s p l a y R e c o r d S e t ( p U i d )   {  
         v a r   f i e l d N a m e   =   ' p '   +   p U i d ;  
         v a r   f i e l d V a l u e   =   d o c u m e n t . g e t E l e m e n t B y I d ( f i e l d N a m e ) . v a l u e ;      
         r e t u r n   o v e r l i b ( f i e l d V a l u e , C A P T I O N , ' ' , T E X T F O N T C L A S S , ' O r a B G A c c e n t L i g h t ' , C A P T I O N F O N T C L A S S , ' O r a C a l e n d a r H e a d e r ' ,   M O U S E O F F ,   V A U T O ,   H A U T O   ,   S T I C K Y ,   O F F S E T X ,   - 1 6 0 ) ;  
     }  
    
    
   f u n c t i o n   e n a b l e A l l F i e l d s ( f o r m ) {  
                  
                     v a r   v a l i d a t e d   =   _ v a l i d a t e F o r m ( f o r m ) ;  
                     / / a l e r t ( ' v a l i d a t e d :   '   +   v a l i d a t e d ) ;  
                      
                     i f   ( v a l i d a t e d ) {  
                         i f   ( ! v a l C h e c k B o x ( f o r m ) ) {    
                       / /       a l e r t ( ' P l e a s e   c h e c k ,   N O T   V A L I D A T E D ! ' ) ;  
                             r e t u r n   f a l s e ;  
                         }  
                     }  
                      
                     i f   ( v a l i d a t e d ) {  
                     v a r   c o u n t   =   f o r m . e l e m e n t s . l e n g t h ;  
    
                     f o r   ( i = 0 ;   i < c o u n t ;   i + + ) {  
                         v a r   e l e m e n t   =   f o r m . e l e m e n t s [ i ] ;  
                         / / e x c l u d e   c h a r a c t e r   c o u n t e r   i n p u t   f i e l d s   ( r e m L e n )  
                         i f ( e l e m e n t . d i s a b l e d   = =   t r u e   & &   e l e m e n t . n a m e . i n d e x O f ( ' r e m L e n ' )   = =   - 1 ) {  
                                 e l e m e n t . d i s a b l e d   =   f a l s e ;  
                                 / / a l e r t ( e l e m e n t . n a m e   +   ' ,   d i s a b l e d   =   f a l s e ' ) ;  
                         }  
                     }  
                     / / a l e r t ( ' t r u e ' )  
                     r e t u r n   t r u e ;  
                 } e l s e {  
                   / / a l e r t ( ' f a l s e ' ) ;  
                   r e t u r n   f a l s e ;    
                 }  
         }  
          
           f u n c t i o n   v a l C h e c k B o x ( f o r m ) {  
        
                   v a r   c o u n t   =   f o r m . e l e m e n t s . l e n g t h ;  
             / /       a l e r t ( ' F o r m   E l e m e n t   C o u n t   :   '   +   c o u n t ) ;  
                    
                     f o r   ( i = 0 ;   i < c o u n t ;   i + + ) {  
                         v a r   e l e m e n t   =   f o r m . e l e m e n t s [ i ] ;  
                   / /         a l e r t ( ' E l e m e n t   N a m e   :   '   +   e l e m e n t . n a m e ) ;  
                   / /           a l e r t ( ' E l e m e n t   I D   :   '   +   e l e m e n t . i d ) ;  
                   / /               a l e r t ( ' E l e m e n t   S h o r t D e s c   :   '   +   e l e m e n t . s h o r t D e s c ) ;  
                   / /         a l e r t ( ' E l e m e n t   T y p e   :   '   +   e l e m e n t . t y p e   ) ;  
                              
                         i f   ( e l e m e n t . t y p e   = =   ' c h e c k b o x ' )   {  
                     / /       a l e r t ( ' I t   i s   C h e c k b o x   : '   ) ;  
                               i f   ( e l e m e n t . i d . i n d e x O f ( ' y e s ' )   > =   0 )   {  
                           / /           a l e r t ( ' I t   i s   R e q u i r e d '   ) ;  
                                     i f   ( e l e m e n t . c h e c k e d   = =   f a l s e )   {  
                                             i   =   i + 1 ;  
                                             v a r   h i d d e n C h e c k b o x   =   f o r m . e l e m e n t s [ i ] ;      
                              
                                             i f   ( h i d d e n C h e c k b o x . i d   = =   e l e m e n t . n a m e )   {    
                                                 a l e r t ( ' A   v a l u e   m u s t   b e   e n t e r e d   f o r   " '   +   h i d d e n C h e c k b o x . v a l u e   +   ' " . ' ) ;  
                                             }  
                                             e l s e   {  
                                                 a l e r t ( ' A   v a l u e   m u s t   b e   e n t e r e d   f o r   t h e   r e q u i r e d   c h e c k b o x . ' ) ;  
                                             }  
                                          
                                         r e t u r n   f a l s e ;  
                                   }     / /     i f   ( e l e m e n t . c h e c k e d   = =   f a l s e )   {  
                             }   / /   i f   ( e l e m e n t . i d . i n d e x O f ( ' y e s ' )   > =   0 )   {  
                         }   / /       i f   ( e l e m e n t . t y p e   = =   ' c h e c k b o x ' )   {  
                     }     / /       f o r   ( i = 0 ;   i < c o u n t ;   i + + ) {  
                 r e t u r n   t r u e ;  
     }  
    
    
   f u n c t i o n   h m c a l e n d a r p o p u p ( p a r a m n a m e ,   d a t e F o r m a t ) {    
  
         v a r   p a r a m v a l u e   =   n u l l ;    
         v a r   w i n c a l e n d a r   =   n u l l ;    
          
 	 v a r   l i n k   =   ' / i t a s / h m c a l e n d a r . j s p ? d a t e f o r m a t = '   +   d a t e F o r m a t   +   ' & t a r g e t f i e l d = '   +   p a r a m n a m e ;  
     / / a l e r t ( ' d a t e V a l u e :   '   +   d o c u m e n t . g e t E l e m e n t B y I d ( p a r a m n a m e ) . v a l u e   +   ' d a t e F o r m a t :   '   +   d a t e F o r m a t ) ; 	  
 	 v a r   d a t e V a l u e   =   d o c u m e n t . g e t E l e m e n t B y I d ( p a r a m n a m e ) . v a l u e ;  
 	  
         i f   ( d a t e V a l u e   = =   ' ' )    
                 p a r a m v a l u e   =   ' n u l l ' ;    
         e l s e   {  
                 l i n k     =   l i n k   +   ' & c a l e n d a r d a t e = '   +   d a t e V a l u e ;    
         }  
 	 	  
 	 w i n c a l e n d e r   =   w i n d o w . o p e n ( l i n k , ' C a l e n d a r ' , ' w i d t h = 2 8 5 , h e i g h t = 2 9 0 , s c r o l l b a r s = n o , d e p e n d e n t = n o , r e s i z a b l e = y e s ' ) ;    
 	  
 	 i f   ( w i n c a l e n d e r   ! =   n u l l )   {    
 	  
 	 	 i f   ( w i n c a l e n d e r . o p e n e r   = =   n u l l )    
 	 	 	 w i n c a l e n d e r . o p e n e r   =   s e l f ;   	  
 	 	  
 	 	 }  
 	  
 	 w i n c a l e n d e r . f o c u s ( ) ;    
 }  
  
 / / o p e n   s c h e d u l e r   p o p u p   o n   r e s o u r c e P l a n . u i x  
 f u n c t i o n   o p e n S c h e d u l e r P o p u p W i t h D R e s o u r c e s ( e n t r y U i d ,   d e f a u l t G r o u p ,   d e d i c a t e d R e s o u r c e s ,   C S I )  
 {  
     v a r   u r l =   ' r e a s s i g n D a y _ p o p u p . d o ? E N T R Y _ U I D = ' . c o n c a t ( e n t r y U i d ) ;  
     u r l   =   u r l   +   ' & R E S O U R C E _ U I D = '   +   d e f a u l t G r o u p   +   ' & D _ R E S O U R C E S = '   +   d e d i c a t e d R e s o u r c e s   +   ' & C S I = '   +   C S I ;  
     / / a l e r t ( d e d i c a t e d R e s o u r c e s   +   "       "   +   C S I ) ;  
     r e t u r n   o p e n W i n d o w ( w i n d o w , u r l ,      
                         ' r e a s s i g n P o p U p W i n d o w ' ,  
                         { w i d t h : 1 0 0 0 ,   h e i g h t : 8 0 0 ,   l e f t : 1 0 0 ,   t o p : 2 0 ,   s t a t u s b a r : 1 , m e n u b a r : 0 ,   s c r o l l b a r s : 1 ,   r e s i z a b l e : 1 } ,  
                         t r u e , ' d i a l o g ' ,   n u l l ) ;    
 }  
  
 / / o p e n   s c h e d u l e r   p o p u p   o n   r e s e r v a t i o n   p a g e   ( c a l E n t r y 2 . d o )  
 f u n c t i o n   o p e n S c h e d u l e r P o p u p ( e n t r y U i d ,   d e f a u l t G r o u p )  
 {  
     v a r   u r l =   ' r e a s s i g n D a y _ p o p u p . d o ? E N T R Y _ U I D = ' . c o n c a t ( e n t r y U i d ) ;  
     u r l   =   u r l   +   ' & R E S O U R C E _ U I D = '   +   d e f a u l t G r o u p ;  
     / / a l e r t ( e n t r y U i d ) ;  
     r e t u r n   o p e n W i n d o w ( w i n d o w , u r l ,      
                         ' r e a s s i g n P o p U p W i n d o w ' ,  
                         { w i d t h : 1 0 0 0 ,   h e i g h t : 8 0 0 ,   l e f t : 1 0 0 ,   t o p : 2 0 ,   s t a t u s b a r : 1 , m e n u b a r : 0 ,   s c r o l l b a r s : 1 ,   r e s i z a b l e : 1 } ,  
                         t r u e , ' d i a l o g ' ,   n u l l ) ;    
 }  
  
 / / o p e n   s c h e d u l e r   p o p u p   o n   r e s e r v a t i o n   p a g e   ( c a l E n t r y 2 . d o )  
 f u n c t i o n   o p e n S c h e d u l e r P o p u p W i t h O b j e c t ( e n t r y U i d ,   d e f a u l t G r o u p ,   o b j e c t U i d )  
 {  
     v a r   u r l =   ' r e a s s i g n D a y _ p o p u p . d o ? E N T R Y _ U I D = ' . c o n c a t ( e n t r y U i d ) ;  
     u r l   =   u r l   +   ' & R E S O U R C E _ U I D = '   +   d e f a u l t G r o u p ;  
     u r l   =   u r l   +   ' & O B J E C T _ U I D = '   +   o b j e c t U i d ;  
  
     r e t u r n   o p e n W i n d o w ( w i n d o w , u r l ,      
                         ' r e a s s i g n P o p U p W i n d o w ' ,  
                         { w i d t h : 1 0 0 0 ,   h e i g h t : 8 0 0 ,   l e f t : 1 0 0 ,   t o p : 2 0 ,   s t a t u s b a r : 1 , m e n u b a r : 0 ,   s c r o l l b a r s : 1 ,   r e s i z a b l e : 1 } ,  
                         t r u e , ' d i a l o g ' ,   n u l l ) ;    
 }  
  
  
 / / o p e n   C a l e n d a r   p o p u p   w i n d o w  
 f u n c t i o n   o p e n C a l P o p u p ( f i e l d n a m e )  
 {  
     / / a l e r t ( t a r g e t P a g e ) ;  
     v a r   u r l   =   ' c a l G r D a y _ p o p u p . d o ? C A L F I E L D = ' . c o n c a t ( f i e l d n a m e ) ;    
     r e t u r n   o p e n W i n d o w ( w i n d o w , u r l ,      
                         ' c a l P o p U p W i n d o w ' ,  
                         { w i d t h : 1 2 0 0 ,   h e i g h t : 8 0 0 ,   l e f t : 5 0 ,   t o p : 2 0 ,   s t a t u s b a r : 1 , m e n u b a r : 0 ,   s c r o l l b a r s : 1 ,   r e s i z a b l e : 1 } ,  
                         t r u e , ' d i a l o g ' ,   n u l l ) ;    
 }  
  
 f u n c t i o n   s e l e c t S h i f t ( w r k H r S t a r t ,   r I d ,   r N a m e ,   w r k H r E n d )  
 {  
  
         v a r   a g r e e   =   c o n f i r m ( ' S t a r t   T i m e :   '   +   w r k H r S t a r t   +   '   A s s i g n e e :   '   +   r N a m e   +   '   E n d   T i m e :   '   +   w r k H r E n d ) ;  
      
 	 i f   ( a g r e e   = =   t r u e ) {  
 	  
 	 	 v a r   p a r a m C a l   =   " C A L F I E L D " ;   / / m u s t   a l w a y s   b e   p o p u l a t e d   w i t h   t i m e  
 	 	 v a r   c a l I d   =   d o c u m e n t . g e t E l e m e n t B y I d ( p a r a m C a l ) . v a l u e ;  
 	 	 / / a l e r t ( ' c a l I d :   '   +   c a l I d ) ;  
  
 	 	 v a r   p a r a m R e s   =   " T A R G E T F I E L D 0 " ;   / / c a n   b e   N U L L ;   T A R G E T F I E L D 0   m u s t   b e   r e s o u r c e  
 	 	 v a r   r e s I d   =   d o c u m e n t . g e t E l e m e n t B y I d ( p a r a m R e s ) . v a l u e ;  
 	 	 / / a l e r t ( ' r e s I d :   '   +   r e s I d ) ;      
  
 	 	 v a r   t a r g e t 1   =   " T A R G E T F I E L D 1 " ;   / / c a n   b e   N U L L ;  
 	 	 v a r   t a r g e t 1 I d   =   d o c u m e n t . g e t E l e m e n t B y I d ( t a r g e t 1 ) . v a l u e ;  
 	 	 / / a l e r t ( ' t a r g e t 1 I d :   '   +   t a r g e t 1 I d ) ;  
  
 	 	 / /   g e t   t h e   d a t e   f i e l d   i n   t h e   p a r e n t   w i n d o w  
 	 	 v a r   c a l F i e l d   =   o p e n e r . d o c u m e n t . g e t E l e m e n t B y I d ( c a l I d ) ;  
 	 	 c a l F i e l d . v a l u e   =   u n e s c a p e ( w r k H r S t a r t ) ;   / / s e t   t i m e  
 	  
 	 	 i f   ( t a r g e t 1 I d . l e n g t h   >   0 ) {   / / s e t   r e s o u r c e ;   p a r a m e t e r 4 7 9 9   - - >   p 4 7 9 9  
 	 	 	 v a r   t a r g e t 1 F i e l d   =   o p e n e r . d o c u m e n t . g e t E l e m e n t B y I d ( t a r g e t 1 I d ) ;  
 	 	 	 / / a l e r t ( ' t a r g e t 1 F i e l d :   '   +   t a r g e t 1 F i e l d ) ;  
 	 	 	 t a r g e t 1 F i e l d . v a l u e   =   u n e s c a p e ( w r k H r E n d ) ;   / / s e t   t i m e  
 	 	 	  
 	 	 }  
      
 	 	 i f   ( r e s I d . l e n g t h   >   0 ) {   / / s e t   r e s o u r c e ;   p a r a m e t e r 4 7 9 9   - - >   p 4 7 9 9  
          
 	 	 	 / / p a r a m e t e r 4 7 9 9   - - >   p 4 7 9 9  
 	 	 	 v a r   p V a l u e   =   ' p ' + r e s I d . s u b s t r i n g ( 9 ) ;  
 	 	 	 / / a l e r t ( ' p V a l u e :   '   +   p V a l u e ) ;  
          
 	 	 	 / / p a r a m e t e r 4 7 9 9   - - >   p a 4 7 9 9  
 	 	 	 v a r   p a V a l u e   =   ' p a ' + r e s I d . s u b s t r i n g ( 9 ) ;  
 	 	 	 / / a l e r t ( ' p a V a l u e :   '   +   p a V a l u e ) ;          
          
 	 	 	 v a r   r e s F i e l d   =   o p e n e r . d o c u m e n t . g e t E l e m e n t B y I d ( p V a l u e ) ;   / /  
 	 	 	 / / a l e r t ( ' o b j e c t   f o u n d   [ p V a l u e ] :   '   +   r e s F i e l d ) ;  
 	 	 	 r e s F i e l d . v a l u e   =   u n e s c a p e ( r I d ) ;  
      
 	 	 	 v a r   r e s D i s p l a y F i e l d   =   o p e n e r . d o c u m e n t . g e t E l e m e n t B y I d ( p a V a l u e ) ;  
 	 	 	 / / a l e r t ( ' o b j e c t   f o u n d   [ p a V a l u e ] :   '   +   r e s D i s p l a y F i e l d ) ;  
 	 	 	 r e s D i s p l a y F i e l d . v a l u e   =   u n e s c a p e ( r N a m e ) ;  
 	 	 } 	  
 	 	  
 	 	 c a l F i e l d . o n c h a n g e ( ) ; 	 	  
 	 	  
 	 	 w i n d o w . c l o s e ( ) ; 	  
 	 }   e l s e   {  
 	 	 r e t u r n   f a l s e   ;  
 	 } 	  
 } 	  
  
 / *   - -   p o p u l a t e   t h e   d a t e   f i e l d   i n   o p e n e r   w i n d o w ,   w h o s e   i d   i s   t h e   v a l u e   o f   C A L F I E L D   p a r a m e t e r  
   *   - -   i f   A D D _ U I D _ T H R O U G H _ P O P U P   e v e n t   i s   d e f i n e d ,   a l s o   p o p u l a t e   t a r g e t   f i e l d   d e f i n e d   i n   e v e n t   ( o p t i o n a l )    
   *   - -   t i m e :   m u s t   n o t   b e   N U L L  
   *   - -   r I d :   c a n   b e   N U L L  
   *   - -   r N a m e :   c a n   b e   N U L L  
   * * /  
 f u n c t i o n   s e l e c t ( t i m e ,   r I d ,   r N a m e ,   w r k H r D u r a t i o n ,   r e f e r e n c e T Z )  
 {  
     / / g e t E l e m e n t B y N a m e   n o t   w o r k i n g ;   U s e   g e t E l e m e n t B y I d   i n s t e a d .  
     / / u s e   h i d d e n   f i e l d   ( C A L F I E L D )   t o   s t o r e   t h e   v a l u e   o f   t h e   p a r a m   n a m e d   C A L F I E L D  
          
         v a r   r T Z   = ' ' ;  
         i f   ( r e f e r e n c e T Z . l e n g t h   >   0 ) {  
             r T Z   =   ' / ' +   r e f e r e n c e T Z ;              
         }      
          
         v a r   a g r e e   =   c o n f i r m ( ' S t a r t   T i m e '   +   r T Z   + ' :   '   +   t i m e   +   '   A s s i g n e e :   '   +   r N a m e   +   '   D u r a t i o n :   '   +   w r k H r D u r a t i o n ) ;  
      
 	 i f   ( a g r e e   = =   t r u e ) { 	  
 	  
 	 	 / / v a r   D   =   n e w   D a t e ( g e t D a t e F r o m F o r m a t ( t i m e , ' d d - M M M - y y y y   H H : m m ' ) ) ;  
 	 	 v a r   D   =   p a r s e D a t e ( t i m e ) ;  
 	  
 	 	 / / a l e r t ( ' t i m e ( 0 ) :   '   +   f o r m a t D a t e ( D , ' d d - M M M - y y y y   H H : m m ' ) ) ;  
 	 	 v a r   t e m p   =   n e w   A r r a y ( ) ;  
 	 	 t e m p   =   w r k H r D u r a t i o n . s p l i t ( ' : ' ) ;  
  
 	 	 v a r   h o u r s   =   t e m p [ 0 ] ;  
 	 	 / / a l e r t ( ' h o u r s :   '   +   h o u r s ) ;  
 	 	 v a r   m i n s   =   t e m p [ 1 ] ;  
 	 	 / / a l e r t ( ' m i n s :   '   +   m i n s ) ;  
 	  
 	 	 D . s e t H o u r s ( D . g e t H o u r s ( )   +   ( h o u r s   *   1 ) ) ;   / / S t r i n g   t o   n u m b e r  
 	 	 D . s e t M i n u t e s ( D . g e t M i n u t e s ( )   +   ( m i n s   *   1 ) )   / / S t r i n g   t o   n u m b e r  
        
 	 	 / / a l e r t ( ' t i m e ( 1 ) :   '   +   f o r m a t D a t e ( D , ' d d - M M M - y y y y   H H : m m ' ) ) ; 	  
 	 	 v a r   e n d T i m e   =   f o r m a t D a t e ( D , g e t D a t e F o r m a t ( t i m e ) ) ;      
      
 	 	 v a r   p a r a m C a l   =   " C A L F I E L D " ;   / / m u s t   a l w a y s   b e   p o p u l a t e d   w i t h   t i m e  
 	 	 v a r   c a l I d   =   d o c u m e n t . g e t E l e m e n t B y I d ( p a r a m C a l ) . v a l u e ;  
 	 	 / / a l e r t ( ' c a l I d :   '   +   c a l I d ) ;  
  
 	 	 v a r   p a r a m R e s   =   " T A R G E T F I E L D 0 " ;   / / c a n   b e   N U L L ;   T A R G E T F I E L D 0   m u s t   b e   r e s o u r c e  
 	 	 v a r   r e s I d   =   d o c u m e n t . g e t E l e m e n t B y I d ( p a r a m R e s ) . v a l u e ;  
 	 	 / /   a l e r t ( ' r e s I d / r e s o u r c e :   '   +   r e s I d ) ;      
  
 	 	 v a r   t a r g e t 1   =   " T A R G E T F I E L D 1 " ;   / / c a n   b e   N U L L ;  
 	 	 v a r   t a r g e t 1 I d   =   d o c u m e n t . g e t E l e m e n t B y I d ( t a r g e t 1 ) . v a l u e ;  
 	 	 / / a l e r t ( ' t a r g e t 1 I d :   '   +   t a r g e t 1 I d ) ;  
  
 	 	 / /   g e t   t h e   d a t e   f i e l d   i n   t h e   p a r e n t   w i n d o w  
 	 	 v a r   c a l F i e l d   =   o p e n e r . d o c u m e n t . g e t E l e m e n t B y I d ( c a l I d ) ;  
 	 	 c a l F i e l d . v a l u e   =   u n e s c a p e ( t i m e ) ;   / / s e t   t i m e 	 	  
  
 	 	 i f   ( t a r g e t 1 I d . l e n g t h   >   0 ) {   / / s e t   S c h e d u l e   E n d    
 	 	 	 v a r   t a r g e t 1 F i e l d   =   o p e n e r . d o c u m e n t . g e t E l e m e n t B y I d ( t a r g e t 1 I d ) ;  
 	 	 	 / / a l e r t ( ' t a r g e t 1 F i e l d :   '   +   t a r g e t 1 F i e l d ) ;  
 	 	 	 t a r g e t 1 F i e l d . v a l u e   =   u n e s c a p e ( e n d T i m e ) ;   / / s e t   t i m e  
             / / t a r g e t 1 F i e l d . o n c h a n g e ( ) ;   / / t r i g g e r   U I   e v e n t s   w i t h   ' S c h e d u l e   E n d '   a s   s o u r c e   f i e l d   ( e . g :   p r e f i l l   ' S c h e d u l e   O u t a g e   E n d ' )  
 	 	 }  
      
 	 	 i f   ( r e s I d . l e n g t h   >   0 ) {   / / s e t   r e s o u r c e ;   p a r a m e t e r 4 7 9 9   - - >   p 4 7 9 9  
          
 	 	 	 / / p a r a m e t e r 4 7 9 9   - - >   p 4 7 9 9  
 	 	 	 v a r   p V a l u e   =   ' p ' + r e s I d . s u b s t r i n g ( 9 ) ;  
 	 	 	 / / a l e r t ( ' p V a l u e :   '   +   p V a l u e ) ;  
          
 	 	 	 / / p a r a m e t e r 4 7 9 9   - - >   p a 4 7 9 9  
 	 	 	 v a r   p a V a l u e   =   ' p a ' + r e s I d . s u b s t r i n g ( 9 ) ;  
 	 	 	 / / a l e r t ( ' p a V a l u e :   '   +   p a V a l u e ) ;          
          
 	 	 	 v a r   r e s F i e l d   =   o p e n e r . d o c u m e n t . g e t E l e m e n t B y I d ( p V a l u e ) ;   / /  
 	 	 	 / / a l e r t ( ' o b j e c t   f o u n d   [ p V a l u e ] :   '   +   r e s F i e l d ) ;  
 	 	 	 r e s F i e l d . v a l u e   =   u n e s c a p e ( r I d ) ;  
      
 	 	 	 v a r   r e s D i s p l a y F i e l d   =   o p e n e r . d o c u m e n t . g e t E l e m e n t B y I d ( p a V a l u e ) ;  
 	 	 	 / / a l e r t ( ' o b j e c t   f o u n d   [ p a V a l u e ] :   '   +   r e s D i s p l a y F i e l d ) ;  
 	 	 	 r e s D i s p l a y F i e l d . v a l u e   =   u n e s c a p e ( r N a m e ) ;  
 	 	 } 	  
 	 	  
 	 	 c a l F i e l d . o n c h a n g e ( ) ;  
 	 	  
 	 	 w i n d o w . c l o s e ( ) ;   	  
 	 }   e l s e   {  
 	 	 r e t u r n   f a l s e   ;  
 	 }  
          
     / * * p a r e n t . l o c a t i o n . r e l o a d ( ) ; * * /  
 }  
  
  
 f u n c t i o n   o p e n C a l P o p u p 2 ( f i e l d n a m e )  
 {  
     v a r   u r l =   ' c m D a y _ p o p u p . d o ? C A L F I E L D = ' . c o n c a t ( f i e l d n a m e ) ;    
     r e t u r n   o p e n W i n d o w ( w i n d o w , u r l ,      
                         ' c m P o p U p W i n d o w ' ,  
                         { w i d t h : 1 0 0 0 ,   h e i g h t : 8 0 0 ,   l e f t : 1 0 0 ,   t o p : 2 0 ,   s t a t u s b a r : 1 , m e n u b a r : 0 ,   s c r o l l b a r s : 1 ,   r e s i z a b l e : 1 } ,  
                         t r u e , ' d i a l o g ' ,   n u l l ) ;    
 }  
  
 f u n c t i o n   o p e n C a l P o p u p 3 ( f i e l d n a m e , e n t r y I d )  
 {  
     / / v a r   u r l =   ' r e S c h e d u l e _ p o p u p . d o ? C A L F I E L D = ' . c o n c a t ( f i e l d n a m e ) ;    
     v a r   u r l =   ' r e S c h e d u l e _ p o p u p . d o ? C A L F I E L D = '   +   f i e l d n a m e   +   ' & e n t r y U i d = '   +   e n t r y I d ;  
     r e t u r n   o p e n W i n d o w ( w i n d o w , u r l ,      
                         ' r e S c h e d u l e P o p U p W i n d o w ' ,  
                         { w i d t h : 1 0 0 0 ,   h e i g h t : 8 0 0 ,   l e f t : 1 0 0 ,   t o p : 2 0 ,   s t a t u s b a r : 1 , m e n u b a r : 0 ,   s c r o l l b a r s : 1 ,   r e s i z a b l e : 1 } ,  
                         t r u e , ' d i a l o g ' ,   r e f r e s h P a g e ) ;    
 }  
  
 f u n c t i o n   o p e n L o v T a b l e ( p a r e n t P a r a m e t e r U i d )  
 {  
     / / v a r   u r l =   ' r e S c h e d u l e _ p o p u p . d o ? C A L F I E L D = ' . c o n c a t ( f i e l d n a m e ) ;    
     v a r   u r l =   ' l o v T a b l e . d o ? p a r e n t P a r a m e t e r U i d = '   +   p a r e n t P a r a m e t e r U i d ;  
     r e t u r n   o p e n W i n d o w ( w i n d o w , u r l ,      
                         ' L o v T a b l e ' ,  
                         { w i d t h : 1 0 0 0 ,   h e i g h t : 8 0 0 ,   l e f t : 1 0 0 ,   t o p : 2 0 ,   s t a t u s b a r : 1 , m e n u b a r : 0 ,   s c r o l l b a r s : 1 ,   r e s i z a b l e : 1 } ,  
                         t r u e , ' d i a l o g ' ,   r e f r e s h P a g e ) ;    
 }  
  
  
 f u n c t i o n   r e f r e s h P a g e ( )    
 {    
     _ u i x s p u ( ' f o r m 0 ' , 0 , ' r e f r e s h A f t e r S e a r c h ' , ' M _ _ I d ' , ' I t a s R e q u e s t D e t a i l s H o m e V O 1 3 ' , 1 , 0 ) ;    
     / * * *   v a r   c o n f i r m a t i o n   =   c o n f i r m   ( " A r e   y o u   s u r e   y o u   w a n t   t o   r e f r e s h " ) ;    
     i f   ( c o n f i r m a t i o n   = =   t r u e   )   {   / / s u b m i t F o r m ( d o c u m e n t . f o r m 0 , 1 , { ' e v e n t ' : ' r e f r e s h A f t e r S e a r c h ' } ) ;   }   * * * /    
 }  
  
  
  
 f u n c t i o n   c m S e l e c t ( t i m e , e n t r y U i d )  
 {  
     / / g e t E l e m e n t B y N a m e   n o t   w o r k i n g ;   U s e   g e t E l e m e n t B y I d   i n s t e a d .  
     / / u s e   h i d d e n   f i e l d   ( C A L F I E L D )   t o   s t o r e   t h e   v a l u e   o f   t h e   p a r a m   n a m e d   C A L F I E L D  
     v a r   p a r a m N a m e   =   " C A L F I E L D " ;  
     v a r   e n t r y I d   =   o p e n e r . d o c u m e n t . g e t E l e m e n t B y I d ( " E n t r y U i d " ) ;      
     v a r   f i e l d I d   =   d o c u m e n t . g e t E l e m e n t B y I d ( p a r a m N a m e ) . v a l u e ;  
     / /   g e t   t h e   d a t e   f i e l d   i n   t h e   p a r e n t   w i n d o w  
     v a r   f i e l d   =   o p e n e r . d o c u m e n t . g e t E l e m e n t B y I d ( f i e l d I d ) ;  
     f i e l d . v a l u e   =   u n e s c a p e ( t i m e ) ;  
     e n t r y I d . v a l u e   =   u n e s c a p e ( e n t r y U i d ) ;  
     f i e l d . f o c u s ( ) ;  
     w i n d o w . c l o s e ( ) ;    
     / * * p a r e n t . l o c a t i o n . r e l o a d ( ) ; * * /  
 }  
  
 / / o p e n   F i l e U p l o a d   p o p u p   w i n d o w  
 f u n c t i o n   o p e n F i l e U p l o a d ( d a t a T y p e C o d e ,   f i l e U p l o a d I d ,   n o t e I d )  
 {  
     v a r   u r l =   ' f i l e U p l o a d . d o ? d a t a T y p e C o d e = '   +   d a t a T y p e C o d e   +   ' & f i l e U p l o a d I d = '   +   f i l e U p l o a d I d   +   ' & n o t e I d = '   +   n o t e I d ;  
     r e t u r n   o p e n W i n d o w ( w i n d o w , u r l ,      
                         ' f i l e U p l o a d ' ,  
                         { w i d t h : 5 0 0 ,   h e i g h t : 2 0 0 ,   l e f t : 1 0 0 ,   t o p : 2 0 ,   s t a t u s b a r : 1 , m e n u b a r : 0 ,   s c r o l l b a r s : 1 ,   r e s i z a b l e : 1 } ,  
                         t r u e , ' d i a l o g ' ,   n u l l ) ;    
 }  
  
 / / o p e n   F i l e U p l o a d   p o p u p   w i n d o w  
 f u n c t i o n   o p e n D i s p l a y C l o b ( n o t e U i d )  
 {  
     v a r   u r l =   ' d i s p l a y C l o b . d o ? n o t e U i d = '   +   n o t e U i d ;  
     r e t u r n   o p e n W i n d o w ( w i n d o w , u r l ,      
                         ' d i s p l a y C l o b ' ,  
                         { w i d t h : 1 0 0 0 ,   h e i g h t : 8 0 0 ,   l e f t : 1 0 0 ,   t o p : 2 0 ,   s t a t u s b a r : 1 , m e n u b a r : 0 ,   s c r o l l b a r s : 1 ,   r e s i z a b l e : 1 } ,  
                         t r u e , ' d i a l o g ' ,   n u l l ) ;    
 }  
  
 / / r e t u r n   t o   e v e n t C r e a t e . d o ,   s e t   v a l u e s   i n t o   a p p r o p r i a t e   f i e l d s   f o r   a t t a c h m e n t   c o m p o n e n t  
 f u n c t i o n   r e t u r n E v e n t C r e a t e ( ) {  
     v a r   u r l   =   d o c u m e n t . l o c a t i o n . h r e f ;  
     / / a l e r t ( " U R L :   "   +   u r l ) ;  
      
     i f ( u r l . i n d e x O f ( " z x c v b m _ s u c c e s s " )   ! =   - 1 )   {  
         v a r   _ l e n g t h   =   u r l . l e n g t h ;  
         / / a l e r t ( _ l e n g t h ) ;  
         v a r   _ a   =   u r l . i n d e x O f ( ' & p A t t F = ' ) ;  
         v a r   _ b   =   u r l . i n d e x O f ( ' & p F i l e N a m e = ' ) ;  
         v a r   _ c   =   u r l . i n d e x O f ( ' & p N F i e l d = ' ) ;  
         v a r   _ d   =   u r l . i n d e x O f ( ' & p N U i d = ' ) ;  
          
         / / u p l o a d   f i l e   p a r e n t   i d ,   e . g :   u p l o a d f i e l d I d :   a t t a c h m e n t 2 6 9 8 3 4 7  
         v a r   u p l o a d f i e l d I d   =   u r l . s u b s t r i n g ( _ a + 7 , _ b ) ;  
         / / a l e r t ( ' u p l o a d f i e l d I d :   '   +   u p l o a d f i e l d I d ) ;  
          
         / / v a r   u p l o a d F i e l d   =   o p e n e r . d o c u m e n t . g e t E l e m e n t B y I d ( u p l o a d f i e l d I d ) ;  
         v a r   u p l o a d F i e l d   =   o p e n e r . d o c u m e n t . f o r m s [ " f o r m 0 " ] . e l e m e n t s [ u p l o a d f i e l d I d ] ;  
  
         / / s e t   v a l u e   i n t o   u p l o a d   f i l e   p a r e n t  
         / / a l e r t ( ' u p l o a d F i e l d :   '   +   u p l o a d F i e l d ) ;   / / u n d e f i n e d  
         u p l o a d F i e l d . v a l u e   =   u n e s c a p e ( u r l . s u b s t r i n g ( _ b + 1 1 , _ c ) ) ;  
          
         / / n o t e   u i d   p a r e n t   i d  
         v a r   n o t e I d   =   u r l . s u b s t r i n g ( _ c + 9 , _ d ) ;  
         / / a l e r t ( ' n o t e I d :   '   +   u r l . s u b s t r i n g ( _ c + 9 , _ d ) ) ;  
          
         v a r   n o t e U i d F i e l d   =   o p e n e r . d o c u m e n t . f o r m s [ " f o r m 0 " ] . e l e m e n t s [ n o t e I d ] ;  
          
         / / s e t   v a l u e   i n t o   u p l o a d   f i l e   p a r e n t  
         / / a l e r t ( ' n o t e U i d F i e l d :   '   +   u r l . s u b s t r i n g ( _ d + 7 , _ l e n g t h ) ) ;  
         n o t e U i d F i e l d . v a l u e   =   u n e s c a p e ( u r l . s u b s t r i n g ( _ d + 7 , _ l e n g t h ) ) ;          
          
         u p l o a d F i e l d . f o c u s ( ) ;  
         s e l f . c l o s e ( ) ;  
     }   e l s e   i f ( g e t U R L P a r a m ( ' m s g T y p e ' )   = =   ' e r r o r ' )   {                  
             a l e r t ( g e t V a l i d a t i o n E r r o r s ( g e t U R L P a r a m ( ' m s g ' ) ) ) ;          
     }  
 }  
  
 f u n c t i o n   g e t U R L P a r a m ( s t r P a r a m N a m e ) {  
     v a r   s t r R e t u r n   =   " " ;  
     v a r   s t r H r e f   =   w i n d o w . l o c a t i o n . h r e f ;  
     i f   (   s t r H r e f . i n d e x O f ( " ? " )   >   - 1   ) {  
         v a r   s t r Q u e r y S t r i n g   =   s t r H r e f . s u b s t r ( s t r H r e f . i n d e x O f ( " ? " ) ) . t o L o w e r C a s e ( ) ;  
         v a r   a Q u e r y S t r i n g   =   s t r Q u e r y S t r i n g . s p l i t ( " & " ) ;  
         f o r   (   v a r   i P a r a m   =   0 ;   i P a r a m   <   a Q u e r y S t r i n g . l e n g t h ;   i P a r a m + +   ) {  
             i f   ( a Q u e r y S t r i n g [ i P a r a m ] . i n d e x O f ( s t r P a r a m N a m e . t o L o w e r C a s e ( )   +   " = " )   >   - 1   ) {  
                 v a r   a P a r a m   =   a Q u e r y S t r i n g [ i P a r a m ] . s p l i t ( " = " ) ;  
                 s t r R e t u r n   =   a P a r a m [ 1 ] ;  
                 b r e a k ;  
             }  
         }  
     }  
     r e t u r n   u n e s c a p e ( s t r R e t u r n ) ;  
 }  
  
 f u n c t i o n   g e t V a l i d a t i o n E r r o r s ( e r r o r s ) {  
     v a r   v a l i d a t i o n E r r o r s   =   e r r o r s . r e p l a c e ( / , , / g ,   ' \ n ' ) ;  
     v a l i d a t i o n E r r o r s   =   ' F i l e   U p l o a d   f a i l e d   w h i l e   v a l i d a t i n g   E x c e l   D a t a   d u e   t o   t h e   f o l l o w i n g   v a l i d a t i o n   e r r o r s : \ n ' . c o n c a t ( v a l i d a t i o n E r r o r s ) ;      
     r e t u r n   v a l i d a t i o n E r r o r s ;  
 }  
  
 f u n c t i o n   t e x t C o u n t e r ( f i e l d ,   c o u n t f i e l d ,   m a x l i m i t )   {  
     v a r   a g t = n a v i g a t o r . u s e r A g e n t . t o L o w e r C a s e ( ) ;  
     v a r   l e n g t h D i f f   = g e t L F C R D i f f ( f i e l d . v a l u e ) ;   / /   F F   f r o m   w i n d o w s   o n l y   c o u n t s   l i n e   r e t u r n   a s   o n e   c h a r a c t e r  
  
     i f   (   ( f i e l d . v a l u e . l e n g t h   +   l e n g t h D i f f )   >   m a x l i m i t )    
     {  
         / /   i f   t o o   l o n g . . . t r i m   i t !  
         f i e l d . v a l u e   =   f i e l d . v a l u e . s u b s t r i n g ( 0 ,   m a x l i m i t   -   l e n g t h D i f f ) ;  
     }      
     e l s e  
     {  
         / /   o t h e r w i s e ,   u p d a t e   ' c h a r a c t e r s   l e f t '   c o u n t e r  
         c o u n t f i e l d . v a l u e   =   m a x l i m i t   -   ( f i e l d . v a l u e . l e n g t h   +   l e n g t h D i f f ) ;  
         / / a l e r t ( " i n p u t = [ "   +   f i e l d . v a l u e   +   " ]   F i n a l   l e n g t h = "   +   c o u n t f i e l d . v a l u e     +   "   m a x L i m i t = " +   m a x l i m i t   +   "   f i e l d . v a l u e . l e n g t h = " +   f i e l d . v a l u e . l e n g t h   +   "   l e n g t h D i f f = "   +   l e n g t h D i f f ) ;  
     }  
 }  
  
 f u n c t i o n   m s g T e x t C o u n t e r ( f i e l d ,   c o u n t f i e l d ,   m a x l i m i t )   {  
     v a r   a g t = n a v i g a t o r . u s e r A g e n t . t o L o w e r C a s e ( ) ;  
     v a r   l e n g t h D i f f   = g e t L F C R D i f f ( f i e l d . v a l u e ) ;   / /   F F   f r o m   w i n d o w s   o n l y   c o u n t s   l i n e   r e t u r n   a s   o n e   c h a r a c t e r  
  
     i f   (   ( f i e l d . v a l u e . l e n g t h   +   l e n g t h D i f f )   >   m a x l i m i t )    
     {  
         / /   i f   t o o   l o n g . . . t r i m   i t !  
         f i e l d . v a l u e   =   f i e l d . v a l u e . s u b s t r i n g ( 0 ,   m a x l i m i t   -   l e n g t h D i f f ) ;  
         / / f i e l d . v a l u e   =   ' c h a r .   l e f t   ( m a x .   '   + m a x l i m i t   +   ' ) :   '   +   ( f i e l d . v a l u e . s u b s t r i n g ( 0 ,   m a x l i m i t   -   l e n g t h D i f f ) ) ;  
     }      
     e l s e  
     {  
         / /   o t h e r w i s e ,   u p d a t e   ' c h a r a c t e r s   l e f t '   c o u n t e r  
         / / c o u n t f i e l d . v a l u e   =   m a x l i m i t   -   ( f i e l d . v a l u e . l e n g t h   +   l e n g t h D i f f ) ;  
         c o u n t f i e l d . v a l u e   =   ' c h a r .   l e f t   ( m a x .   '   + m a x l i m i t   +   ' ) :   '   +   ( m a x l i m i t   -   ( f i e l d . v a l u e . l e n g t h   +   l e n g t h D i f f )   ) ;  
         / / a l e r t ( " i n p u t = [ "   +   f i e l d . v a l u e   +   " ]   F i n a l   l e n g t h = "   +   c o u n t f i e l d . v a l u e     +   "   m a x L i m i t = " +   m a x l i m i t   +   "   f i e l d . v a l u e . l e n g t h = " +   f i e l d . v a l u e . l e n g t h   +   "   l e n g t h D i f f = "   +   l e n g t h D i f f ) ;  
     }  
 }  
  
  
 f u n c t i o n   g e t L F C R D i f f ( t e x t s t r )  
 {  
     v a r   a g t = n a v i g a t o r . u s e r A g e n t . t o L o w e r C a s e ( ) ;  
     v a r   i s F F W i n d o w s =   ( a g t . i n d e x O f ( ' f i r e f o x ' )   >   - 1 )   & &   ( a g t . i n d e x O f ( ' w i n d o w s ' )   >   - 1 ) ;  
  
     l f c o u n t   =   0 ;  
     c r c o u n t   =   0 ;  
     c o u n t d i f f   =   0 ;  
     i f   ( i s F F W i n d o w s )  
     {  
         f o r   ( i = 1 ; i   <   t e x t s t r . l e n g t h ; i + + ) {  
             a   =   t e x t s t r . c h a r C o d e A t ( i ) ;  
             i f   ( a   = =   1 0 ) {  
             l f c o u n t + + ;  
             }  
             i f   ( a   = =   1 3 ) {  
             c r c o u n t + + ;  
             }  
         }  
  
         i f   ( l f c o u n t   ! =   c r c o u n t ) {  
             c o u n t d i f f   =   l f c o u n t   -   c r c o u n t ;  
             / / a l e r t ( " C R / L F   l e n g t h   d i f f :   "   +   c o u n t d i f f ) ;  
         }  
     } ;  
      
     r e t u r n   c o u n t d i f f ;  
 }  
  
 f u n c t i o n   c h e c k C o n s t a n t V a l u e ( )   {      
      
     v a r   f i e l d N a m e   =   ' r o w C o n s t a n t T e x t ' ;  
     v a r   c o n s t a n t F i e l d   =   d o c u m e n t . g e t E l e m e n t B y I d ( f i e l d N a m e ) ;      
     / / v a r   c o n s t a n t V a l u e   =   d o c u m e n t . g e t E l e m e n t B y I d ( f i e l d N a m e ) ;  
     v a r   r e t u r n _ v a l u e   =   t r u e ;  
      
     / / a l e r t ( ' c o n s t a n t F i e l d :   '   +   c o n s t a n t F i e l d ) ;  
      
     i f   ( c o n s t a n t F i e l d . v a l u e   = =   ' '   & &   ! c o n s t a n t F i e l d . d i s a b l e d )  
     {  
         r e t u r n _ v a l u e   =   c o n f i r m ( " C o n s t a n t   V a l u e   i s   e m p t y !   I s   t h i s   c o r r e c t ? " ) ;  
         / / a l e r t ( r e t u r n _ v a l u e ) ;  
         r e t u r n   r e t u r n _ v a l u e  
     }  
 	 r e t u r n   t r u e ;  
 }  
  
 f u n c t i o n   t r i m D a t e ( t a r g e t )   {  
     t a r g e t . v a l u e   =   t a r g e t . v a l u e . r e p l a c e (   / ^ \ s + / g ,   " "   ) ; / /   s t r i p   l e a d i n g  
     t a r g e t . v a l u e   =   t a r g e t . v a l u e . r e p l a c e (   / \ s + $ / g ,   " "   ) ; / /   s t r i p   t r a i l i n g  
 }  
  
  
 / /   = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =  
 / /   A u t h o r :   M a t t   K r u s e   < m a t t @ m a t t k r u s e . c o m >  
 / /   W W W :   h t t p : / / w w w . m a t t k r u s e . c o m /  
 / /  
 / /   N O T I C E :   Y o u   m a y   u s e   t h i s   c o d e   f o r   a n y   p u r p o s e ,   c o m m e r c i a l   o r  
 / /   p r i v a t e ,   w i t h o u t   a n y   f u r t h e r   p e r m i s s i o n   f r o m   t h e   a u t h o r .   Y o u   m a y  
 / /   r e m o v e   t h i s   n o t i c e   f r o m   y o u r   f i n a l   c o d e   i f   y o u   w i s h ,   h o w e v e r   i t   i s  
 / /   a p p r e c i a t e d   b y   t h e   a u t h o r   i f   a t   l e a s t   m y   w e b   s i t e   a d d r e s s   i s   k e p t .  
 / /  
 / /   Y o u   m a y   * N O T *   r e - d i s t r i b u t e   t h i s   c o d e   i n   a n y   w a y   e x c e p t   t h r o u g h   i t s  
 / /   u s e .   T h a t   m e a n s ,   y o u   c a n   i n c l u d e   i t   i n   y o u r   p r o d u c t ,   o r   y o u r   w e b  
 / /   s i t e ,   o r   a n y   o t h e r   f o r m   w h e r e   t h e   c o d e   i s   a c t u a l l y   b e i n g   u s e d .   Y o u  
 / /   m a y   n o t   p u t   t h e   p l a i n   j a v a s c r i p t   u p   o n   y o u r   s i t e   f o r   d o w n l o a d   o r  
 / /   i n c l u d e   i t   i n   y o u r   j a v a s c r i p t   l i b r a r i e s   f o r   d o w n l o a d .    
 / /   I f   y o u   w i s h   t o   s h a r e   t h i s   c o d e   w i t h   o t h e r s ,   p l e a s e   j u s t   p o i n t   t h e m  
 / /   t o   t h e   U R L   i n s t e a d .  
 / /   P l e a s e   D O   N O T   l i n k   d i r e c t l y   t o   m y   . j s   f i l e s   f r o m   y o u r   s i t e .   C o p y  
 / /   t h e   f i l e s   t o   y o u r   s e r v e r   a n d   u s e   t h e m   t h e r e .   T h a n k   y o u .  
 / /   = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =  
  
 / /   H I S T O R Y  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 / /   M a y   1 7 ,   2 0 0 3 :   F i x e d   b u g   i n   p a r s e D a t e ( )   f o r   d a t e s   < 1 9 7 0  
 / /   M a r c h   1 1 ,   2 0 0 3 :   A d d e d   p a r s e D a t e ( )   f u n c t i o n  
 / /   M a r c h   1 1 ,   2 0 0 3 :   A d d e d   " N N N "   f o r m a t t i n g   o p t i o n .   D o e s n ' t   m a t c h   u p  
 / /                                   p e r f e c t l y   w i t h   S i m p l e D a t e F o r m a t   f o r m a t s ,   b u t    
 / /                                   b a c k w a r d s - c o m p a t a b i l i t y   w a s   r e q u i r e d .  
  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 / /   T h e s e   f u n c t i o n s   u s e   t h e   s a m e   ' f o r m a t '   s t r i n g s   a s   t h e    
 / /   j a v a . t e x t . S i m p l e D a t e F o r m a t   c l a s s ,   w i t h   m i n o r   e x c e p t i o n s .  
 / /   T h e   f o r m a t   s t r i n g   c o n s i s t s   o f   t h e   f o l l o w i n g   a b b r e v i a t i o n s :  
 / /    
 / /   F i e l d                 |   F u l l   F o r m                     |   S h o r t   F o r m  
 / /   - - - - - - - - - - - - - + - - - - - - - - - - - - - - - - - - - - + - - - - - - - - - - - - - - - - - - - - - - -  
 / /   Y e a r                   |   y y y y   ( 4   d i g i t s )         |   y y   ( 2   d i g i t s ) ,   y   ( 2   o r   4   d i g i t s )  
 / /   M o n t h                 |   M M M   ( n a m e   o r   a b b r . ) |   M M   ( 2   d i g i t s ) ,   M   ( 1   o r   2   d i g i t s )  
 / /                             |   N N N   ( a b b r . )                 |  
 / /   D a y   o f   M o n t h   |   d d   ( 2   d i g i t s )             |   d   ( 1   o r   2   d i g i t s )  
 / /   D a y   o f   W e e k     |   E E   ( n a m e )                     |   E   ( a b b r )  
 / /   H o u r   ( 1 - 1 2 )     |   h h   ( 2   d i g i t s )             |   h   ( 1   o r   2   d i g i t s )  
 / /   H o u r   ( 0 - 2 3 )     |   H H   ( 2   d i g i t s )             |   H   ( 1   o r   2   d i g i t s )  
 / /   H o u r   ( 0 - 1 1 )     |   K K   ( 2   d i g i t s )             |   K   ( 1   o r   2   d i g i t s )  
 / /   H o u r   ( 1 - 2 4 )     |   k k   ( 2   d i g i t s )             |   k   ( 1   o r   2   d i g i t s )  
 / /   M i n u t e               |   m m   ( 2   d i g i t s )             |   m   ( 1   o r   2   d i g i t s )  
 / /   S e c o n d               |   s s   ( 2   d i g i t s )             |   s   ( 1   o r   2   d i g i t s )  
 / /   A M / P M                 |   a                                     |  
 / /  
 / /   N O T E   T H E   D I F F E R E N C E   B E T W E E N   M M   a n d   m m !   M o n t h = M M ,   n o t   m m !  
 / /   E x a m p l e s :  
 / /     " M M M   d ,   y "   m a t c h e s :   J a n u a r y   0 1 ,   2 0 0 0  
 / /                                             D e c   1 ,   1 9 0 0  
 / /                                             N o v   2 0 ,   0 0  
 / /     " M / d / y y "       m a t c h e s :   0 1 / 2 0 / 0 0  
 / /                                             9 / 2 / 0 0  
 / /     " M M M   d d ,   y y y y   h h : m m : s s a "   m a t c h e s :   " J a n u a r y   0 1 ,   2 0 0 0   1 2 : 3 0 : 4 5 A M "  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
  
 v a r   M O N T H _ N A M E S = n e w   A r r a y ( ' J a n u a r y ' , ' F e b r u a r y ' , ' M a r c h ' , ' A p r i l ' , ' M a y ' , ' J u n e ' , ' J u l y ' , ' A u g u s t ' , ' S e p t e m b e r ' , ' O c t o b e r ' , ' N o v e m b e r ' , ' D e c e m b e r ' , ' J a n ' , ' F e b ' , ' M a r ' , ' A p r ' , ' M a y ' , ' J u n ' , ' J u l ' , ' A u g ' , ' S e p ' , ' O c t ' , ' N o v ' , ' D e c ' ) ;  
 v a r   D A Y _ N A M E S = n e w   A r r a y ( ' S u n d a y ' , ' M o n d a y ' , ' T u e s d a y ' , ' W e d n e s d a y ' , ' T h u r s d a y ' , ' F r i d a y ' , ' S a t u r d a y ' , ' S u n ' , ' M o n ' , ' T u e ' , ' W e d ' , ' T h u ' , ' F r i ' , ' S a t ' ) ;  
 f u n c t i o n   L Z ( x )   { r e t u r n ( x < 0 | | x > 9 ? " " : " 0 " ) + x }  
  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 / /   i s D a t e   (   d a t e _ s t r i n g ,   f o r m a t _ s t r i n g   )  
 / /   R e t u r n s   t r u e   i f   d a t e   s t r i n g   m a t c h e s   f o r m a t   o f   f o r m a t   s t r i n g   a n d  
 / /   i s   a   v a l i d   d a t e .   E l s e   r e t u r n s   f a l s e .  
 / /   I t   i s   r e c o m m e n d e d   t h a t   y o u   t r i m   w h i t e s p a c e   a r o u n d   t h e   v a l u e   b e f o r e  
 / /   p a s s i n g   i t   t o   t h i s   f u n c t i o n ,   a s   w h i t e s p a c e   i s   N O T   i g n o r e d !  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 f u n c t i o n   i s D a t e ( v a l , f o r m a t )   {  
 	 v a r   d a t e = g e t D a t e F r o m F o r m a t ( v a l , f o r m a t ) ;  
 	 i f   ( d a t e = = 0 )   {   r e t u r n   f a l s e ;   }  
 	 r e t u r n   t r u e ;  
 	 }  
  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 / /   c o m p a r e D a t e s ( d a t e 1 , d a t e 1 f o r m a t , d a t e 2 , d a t e 2 f o r m a t )  
 / /       C o m p a r e   t w o   d a t e   s t r i n g s   t o   s e e   w h i c h   i s   g r e a t e r .  
 / /       R e t u r n s :  
 / /       1   i f   d a t e 1   i s   g r e a t e r   t h a n   d a t e 2  
 / /       0   i f   d a t e 2   i s   g r e a t e r   t h a n   d a t e 1   o f   i f   t h e y   a r e   t h e   s a m e  
 / /     - 1   i f   e i t h e r   o f   t h e   d a t e s   i s   i n   a n   i n v a l i d   f o r m a t  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 f u n c t i o n   c o m p a r e D a t e s ( d a t e 1 , d a t e f o r m a t 1 , d a t e 2 , d a t e f o r m a t 2 )   {  
 	 v a r   d 1 = g e t D a t e F r o m F o r m a t ( d a t e 1 , d a t e f o r m a t 1 ) ;  
 	 v a r   d 2 = g e t D a t e F r o m F o r m a t ( d a t e 2 , d a t e f o r m a t 2 ) ;  
 	 i f   ( d 1 = = 0   | |   d 2 = = 0 )   {  
 	 	 r e t u r n   - 1 ;  
 	 	 }  
 	 e l s e   i f   ( d 1   >   d 2 )   {  
 	 	 r e t u r n   1 ;  
 	 	 }  
 	 r e t u r n   0 ;  
 	 }  
  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 / /   f o r m a t D a t e   ( d a t e _ o b j e c t ,   f o r m a t )  
 / /   R e t u r n s   a   d a t e   i n   t h e   o u t p u t   f o r m a t   s p e c i f i e d .  
 / /   T h e   f o r m a t   s t r i n g   u s e s   t h e   s a m e   a b b r e v i a t i o n s   a s   i n   g e t D a t e F r o m F o r m a t ( )  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 f u n c t i o n   f o r m a t D a t e ( d a t e , f o r m a t )   {  
 	 f o r m a t = f o r m a t + " " ;  
 	 v a r   r e s u l t = " " ;  
 	 v a r   i _ f o r m a t = 0 ;  
 	 v a r   c = " " ;  
 	 v a r   t o k e n = " " ;  
 	 v a r   y = d a t e . g e t Y e a r ( ) + " " ;  
 	 v a r   M = d a t e . g e t M o n t h ( ) + 1 ;  
 	 v a r   d = d a t e . g e t D a t e ( ) ;  
 	 v a r   E = d a t e . g e t D a y ( ) ;  
 	 v a r   H = d a t e . g e t H o u r s ( ) ;  
 	 v a r   m = d a t e . g e t M i n u t e s ( ) ;  
 	 v a r   s = d a t e . g e t S e c o n d s ( ) ;  
 	 v a r   y y y y , y y , M M M , M M , d d , h h , h , m m , s s , a m p m , H H , H , K K , K , k k , k ;  
 	 / /   C o n v e r t   r e a l   d a t e   p a r t s   i n t o   f o r m a t t e d   v e r s i o n s  
 	 v a r   v a l u e = n e w   O b j e c t ( ) ;  
 	 i f   ( y . l e n g t h   <   4 )   { y = " " + ( y - 0 + 1 9 0 0 ) ; }  
 	 v a l u e [ " y " ] = " " + y ;  
 	 v a l u e [ " y y y y " ] = y ;  
 	 v a l u e [ " y y " ] = y . s u b s t r i n g ( 2 , 4 ) ;  
 	 v a l u e [ " M " ] = M ;  
 	 v a l u e [ " M M " ] = L Z ( M ) ;  
 	 v a l u e [ " M M M " ] = M O N T H _ N A M E S [ M + 1 1 ] ;  
 	 / / v a l u e [ " N N N " ] = M O N T H _ N A M E S [ M + 1 1 ] ;   / / C B :   e l i m i n a t e   N N N   f o r m a t  
 	 v a l u e [ " d " ] = d ;  
 	 v a l u e [ " d d " ] = L Z ( d ) ;  
 	 v a l u e [ " E " ] = D A Y _ N A M E S [ E + 7 ] ;  
 	 v a l u e [ " E E " ] = D A Y _ N A M E S [ E ] ;  
 	 v a l u e [ " H " ] = H ;  
 	 v a l u e [ " H H " ] = L Z ( H ) ;  
 	 i f   ( H = = 0 ) { v a l u e [ " h " ] = 1 2 ; }  
 	 e l s e   i f   ( H > 1 2 ) { v a l u e [ " h " ] = H - 1 2 ; }  
 	 e l s e   { v a l u e [ " h " ] = H ; }  
 	 v a l u e [ " h h " ] = L Z ( v a l u e [ " h " ] ) ;  
 	 i f   ( H > 1 1 ) { v a l u e [ " K " ] = H - 1 2 ; }   e l s e   { v a l u e [ " K " ] = H ; }  
 	 v a l u e [ " k " ] = H + 1 ;  
 	 v a l u e [ " K K " ] = L Z ( v a l u e [ " K " ] ) ;  
 	 v a l u e [ " k k " ] = L Z ( v a l u e [ " k " ] ) ;  
 	 i f   ( H   >   1 1 )   {   v a l u e [ " a " ] = " P M " ;   }  
 	 e l s e   {   v a l u e [ " a " ] = " A M " ;   }  
 	 v a l u e [ " m " ] = m ;  
 	 v a l u e [ " m m " ] = L Z ( m ) ;  
 	 v a l u e [ " s " ] = s ;  
 	 v a l u e [ " s s " ] = L Z ( s ) ;  
 	 w h i l e   ( i _ f o r m a t   <   f o r m a t . l e n g t h )   {  
 	 	 c = f o r m a t . c h a r A t ( i _ f o r m a t ) ;  
 	 	 t o k e n = " " ;  
 	 	 w h i l e   ( ( f o r m a t . c h a r A t ( i _ f o r m a t ) = = c )   & &   ( i _ f o r m a t   <   f o r m a t . l e n g t h ) )   {  
 	 	 	 t o k e n   + =   f o r m a t . c h a r A t ( i _ f o r m a t + + ) ;  
 	 	 	 }  
 	 	 i f   ( v a l u e [ t o k e n ]   ! =   n u l l )   {   r e s u l t = r e s u l t   +   v a l u e [ t o k e n ] ;   }  
 	 	 e l s e   {   r e s u l t = r e s u l t   +   t o k e n ;   }  
 	 	 }  
 	 r e t u r n   r e s u l t ;  
 	 }  
 	  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 / /   U t i l i t y   f u n c t i o n s   f o r   p a r s i n g   i n   g e t D a t e F r o m F o r m a t ( )  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 f u n c t i o n   _ i s I n t e g e r ( v a l )   {  
 	 v a r   d i g i t s = " 1 2 3 4 5 6 7 8 9 0 " ;  
 	 f o r   ( v a r   i = 0 ;   i   <   v a l . l e n g t h ;   i + + )   {  
 	 	 i f   ( d i g i t s . i n d e x O f ( v a l . c h a r A t ( i ) ) = = - 1 )   {   r e t u r n   f a l s e ;   }  
 	 	 }  
 	 r e t u r n   t r u e ;  
 	 }  
 f u n c t i o n   _ g e t I n t ( s t r , i , m i n l e n g t h , m a x l e n g t h )   {  
 	 f o r   ( v a r   x = m a x l e n g t h ;   x > = m i n l e n g t h ;   x - - )   {  
 	 	 v a r   t o k e n = s t r . s u b s t r i n g ( i , i + x ) ;  
 	 	 i f   ( t o k e n . l e n g t h   <   m i n l e n g t h )   {   r e t u r n   n u l l ;   }  
 	 	 i f   ( _ i s I n t e g e r ( t o k e n ) )   {   r e t u r n   t o k e n ;   }  
 	 	 }  
 	 r e t u r n   n u l l ;  
 	 }  
 	  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 / /   g e t D a t e F r o m F o r m a t (   d a t e _ s t r i n g   ,   f o r m a t _ s t r i n g   )  
 / /  
 / /   T h i s   f u n c t i o n   t a k e s   a   d a t e   s t r i n g   a n d   a   f o r m a t   s t r i n g .   I t   m a t c h e s  
 / /   I f   t h e   d a t e   s t r i n g   m a t c h e s   t h e   f o r m a t   s t r i n g ,   i t   r e t u r n s   t h e    
 / /   g e t T i m e ( )   o f   t h e   d a t e .   I f   i t   d o e s   n o t   m a t c h ,   i t   r e t u r n s   0 .  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 f u n c t i o n   g e t D a t e F r o m F o r m a t ( v a l , f o r m a t )   {  
 	 v a l = v a l + " " ;  
 	 f o r m a t = f o r m a t + " " ;  
 	 v a r   i _ v a l = 0 ;  
 	 v a r   i _ f o r m a t = 0 ;  
 	 v a r   c = " " ;  
 	 v a r   t o k e n = " " ;  
 	 v a r   t o k e n 2 = " " ;  
 	 v a r   x , y ;  
 	 v a r   n o w = n e w   D a t e ( ) ;  
 	 v a r   y e a r = n o w . g e t Y e a r ( ) ;  
 	 v a r   m o n t h = n o w . g e t M o n t h ( ) + 1 ;  
 	 v a r   d a t e = 1 ;  
 	 v a r   h h = n o w . g e t H o u r s ( ) ;  
 	 v a r   m m = n o w . g e t M i n u t e s ( ) ;  
 	 v a r   s s = n o w . g e t S e c o n d s ( ) ;  
 	 v a r   a m p m = " " ;  
 	  
 	 w h i l e   ( i _ f o r m a t   <   f o r m a t . l e n g t h )   {  
 	 	 / /   G e t   n e x t   t o k e n   f r o m   f o r m a t   s t r i n g  
 	 	 c = f o r m a t . c h a r A t ( i _ f o r m a t ) ;  
 	 	 t o k e n = " " ;  
 	 	 w h i l e   ( ( f o r m a t . c h a r A t ( i _ f o r m a t ) = = c )   & &   ( i _ f o r m a t   <   f o r m a t . l e n g t h ) )   {  
 	 	 	 t o k e n   + =   f o r m a t . c h a r A t ( i _ f o r m a t + + ) ;  
 	 	 	 }  
 	 	 / /   E x t r a c t   c o n t e n t s   o f   v a l u e   b a s e d   o n   f o r m a t   t o k e n  
 	 	 i f   ( t o k e n = = " y y y y "   | |   t o k e n = = " y y "   | |   t o k e n = = " y " )   {  
 	 	 	 i f   ( t o k e n = = " y y y y " )   {   x = 4 ; y = 4 ;   }  
 	 	 	 i f   ( t o k e n = = " y y " )       {   x = 2 ; y = 2 ;   }  
 	 	 	 i f   ( t o k e n = = " y " )         {   x = 2 ; y = 4 ;   }  
 	 	 	 y e a r = _ g e t I n t ( v a l , i _ v a l , x , y ) ;  
 	 	 	 i f   ( y e a r = = n u l l )   {   r e t u r n   0 ;   }  
 	 	 	 i _ v a l   + =   y e a r . l e n g t h ;  
 	 	 	 i f   ( y e a r . l e n g t h = = 2 )   {  
 	 	 	 	 i f   ( y e a r   >   7 0 )   {   y e a r = 1 9 0 0 + ( y e a r - 0 ) ;   }  
 	 	 	 	 e l s e   {   y e a r = 2 0 0 0 + ( y e a r - 0 ) ;   }  
 	 	 	 	 }  
 	 	 	 }  
 	 	 e l s e   i f   ( t o k e n = = " M M M " | | t o k e n = = " N N N " ) {  
 	 	 	 m o n t h = 0 ;  
 	 	 	 f o r   ( v a r   i = 0 ;   i < M O N T H _ N A M E S . l e n g t h ;   i + + )   {  
 	 	 	 	 v a r   m o n t h _ n a m e = M O N T H _ N A M E S [ i ] ;  
 	 	 	 	 i f   ( v a l . s u b s t r i n g ( i _ v a l , i _ v a l + m o n t h _ n a m e . l e n g t h ) . t o L o w e r C a s e ( ) = = m o n t h _ n a m e . t o L o w e r C a s e ( ) )   {  
 	 	 	 	 	 i f   ( t o k e n = = " M M M " | | ( t o k e n = = " N N N " & & i > 1 1 ) )   {  
 	 	 	 	 	 	 m o n t h = i + 1 ;  
 	 	 	 	 	 	 i f   ( m o n t h > 1 2 )   {   m o n t h   - =   1 2 ;   }  
 	 	 	 	 	 	 i _ v a l   + =   m o n t h _ n a m e . l e n g t h ;  
 	 	 	 	 	 	 b r e a k ;  
 	 	 	 	 	 	 }  
 	 	 	 	 	 }  
 	 	 	 	 }  
 	 	 	 i f   ( ( m o n t h   <   1 ) | | ( m o n t h > 1 2 ) ) { r e t u r n   0 ; }  
 	 	 	 }  
 	 	 e l s e   i f   ( t o k e n = = " E E " | | t o k e n = = " E " ) {  
 	 	 	 f o r   ( v a r   i = 0 ;   i < D A Y _ N A M E S . l e n g t h ;   i + + )   {  
 	 	 	 	 v a r   d a y _ n a m e = D A Y _ N A M E S [ i ] ;  
 	 	 	 	 i f   ( v a l . s u b s t r i n g ( i _ v a l , i _ v a l + d a y _ n a m e . l e n g t h ) . t o L o w e r C a s e ( ) = = d a y _ n a m e . t o L o w e r C a s e ( ) )   {  
 	 	 	 	 	 i _ v a l   + =   d a y _ n a m e . l e n g t h ;  
 	 	 	 	 	 b r e a k ;  
 	 	 	 	 	 }  
 	 	 	 	 }  
 	 	 	 }  
 	 	 e l s e   i f   ( t o k e n = = " M M " | | t o k e n = = " M " )   {  
 	 	 	 m o n t h = _ g e t I n t ( v a l , i _ v a l , t o k e n . l e n g t h , 2 ) ;  
 	 	 	 i f ( m o n t h = = n u l l | | ( m o n t h < 1 ) | | ( m o n t h > 1 2 ) ) { r e t u r n   0 ; }  
 	 	 	 i _ v a l + = m o n t h . l e n g t h ; }  
 	 	 e l s e   i f   ( t o k e n = = " d d " | | t o k e n = = " d " )   {  
 	 	 	 d a t e = _ g e t I n t ( v a l , i _ v a l , t o k e n . l e n g t h , 2 ) ;  
 	 	 	 i f ( d a t e = = n u l l | | ( d a t e < 1 ) | | ( d a t e > 3 1 ) ) { r e t u r n   0 ; }  
 	 	 	 i _ v a l + = d a t e . l e n g t h ; }  
 	 	 e l s e   i f   ( t o k e n = = " h h " | | t o k e n = = " h " )   {  
 	 	 	 h h = _ g e t I n t ( v a l , i _ v a l , t o k e n . l e n g t h , 2 ) ;  
 	 	 	 i f ( h h = = n u l l | | ( h h < 1 ) | | ( h h > 1 2 ) ) { r e t u r n   0 ; }  
 	 	 	 i _ v a l + = h h . l e n g t h ; }  
 	 	 e l s e   i f   ( t o k e n = = " H H " | | t o k e n = = " H " )   {  
 	 	 	 h h = _ g e t I n t ( v a l , i _ v a l , t o k e n . l e n g t h , 2 ) ;  
 	 	 	 i f ( h h = = n u l l | | ( h h < 0 ) | | ( h h > 2 3 ) ) { r e t u r n   0 ; }  
 	 	 	 i _ v a l + = h h . l e n g t h ; }  
 	 	 e l s e   i f   ( t o k e n = = " K K " | | t o k e n = = " K " )   {  
 	 	 	 h h = _ g e t I n t ( v a l , i _ v a l , t o k e n . l e n g t h , 2 ) ;  
 	 	 	 i f ( h h = = n u l l | | ( h h < 0 ) | | ( h h > 1 1 ) ) { r e t u r n   0 ; }  
 	 	 	 i _ v a l + = h h . l e n g t h ; }  
 	 	 e l s e   i f   ( t o k e n = = " k k " | | t o k e n = = " k " )   {  
 	 	 	 h h = _ g e t I n t ( v a l , i _ v a l , t o k e n . l e n g t h , 2 ) ;  
 	 	 	 i f ( h h = = n u l l | | ( h h < 1 ) | | ( h h > 2 4 ) ) { r e t u r n   0 ; }  
 	 	 	 i _ v a l + = h h . l e n g t h ; h h - - ; }  
 	 	 e l s e   i f   ( t o k e n = = " m m " | | t o k e n = = " m " )   {  
 	 	 	 m m = _ g e t I n t ( v a l , i _ v a l , t o k e n . l e n g t h , 2 ) ;  
 	 	 	 i f ( m m = = n u l l | | ( m m < 0 ) | | ( m m > 5 9 ) ) { r e t u r n   0 ; }  
 	 	 	 i _ v a l + = m m . l e n g t h ; }  
 	 	 e l s e   i f   ( t o k e n = = " s s " | | t o k e n = = " s " )   {  
 	 	 	 s s = _ g e t I n t ( v a l , i _ v a l , t o k e n . l e n g t h , 2 ) ;  
 	 	 	 i f ( s s = = n u l l | | ( s s < 0 ) | | ( s s > 5 9 ) ) { r e t u r n   0 ; }  
 	 	 	 i _ v a l + = s s . l e n g t h ; }  
 	 	 e l s e   i f   ( t o k e n = = " a " )   {  
 	 	 	 i f   ( v a l . s u b s t r i n g ( i _ v a l , i _ v a l + 2 ) . t o L o w e r C a s e ( ) = = " a m " )   { a m p m = " A M " ; }  
 	 	 	 e l s e   i f   ( v a l . s u b s t r i n g ( i _ v a l , i _ v a l + 2 ) . t o L o w e r C a s e ( ) = = " p m " )   { a m p m = " P M " ; }  
 	 	 	 e l s e   { r e t u r n   0 ; }  
 	 	 	 i _ v a l + = 2 ; }  
 	 	 e l s e   {  
 	 	 	 i f   ( v a l . s u b s t r i n g ( i _ v a l , i _ v a l + t o k e n . l e n g t h ) ! = t o k e n )   { r e t u r n   0 ; }  
 	 	 	 e l s e   { i _ v a l + = t o k e n . l e n g t h ; }  
 	 	 	 }  
 	 	 }  
 	 / /   I f   t h e r e   a r e   a n y   t r a i l i n g   c h a r a c t e r s   l e f t   i n   t h e   v a l u e ,   i t   d o e s n ' t   m a t c h  
 	 i f   ( i _ v a l   ! =   v a l . l e n g t h )   {   r e t u r n   0 ;   }  
 	 / /   I s   d a t e   v a l i d   f o r   m o n t h ?  
 	 i f   ( m o n t h = = 2 )   {  
 	 	 / /   C h e c k   f o r   l e a p   y e a r  
 	 	 i f   (   (   ( y e a r % 4 = = 0 ) & & ( y e a r % 1 0 0   ! =   0 )   )   | |   ( y e a r % 4 0 0 = = 0 )   )   {   / /   l e a p   y e a r  
 	 	 	 i f   ( d a t e   >   2 9 ) {   r e t u r n   0 ;   }  
 	 	 	 }  
 	 	 e l s e   {   i f   ( d a t e   >   2 8 )   {   r e t u r n   0 ;   }   }  
 	 	 }  
 	 i f   ( ( m o n t h = = 4 ) | | ( m o n t h = = 6 ) | | ( m o n t h = = 9 ) | | ( m o n t h = = 1 1 ) )   {  
 	 	 i f   ( d a t e   >   3 0 )   {   r e t u r n   0 ;   }  
 	 	 }  
 	 / /   C o r r e c t   h o u r s   v a l u e  
 	 i f   ( h h < 1 2   & &   a m p m = = " P M " )   {   h h = h h - 0 + 1 2 ;   }  
 	 e l s e   i f   ( h h > 1 1   & &   a m p m = = " A M " )   {   h h - = 1 2 ;   }  
 	 v a r   n e w d a t e = n e w   D a t e ( y e a r , m o n t h - 1 , d a t e , h h , m m , s s ) ;  
 	 r e t u r n   n e w d a t e . g e t T i m e ( ) ;  
 	 }  
  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 / /   C B :   r e s t r i c t   t o   c e r t a i n   d a t e   f o r m a t s   - - >   d e r i v e d   f r o m   I t a s C u s t o m D a t e  
 / /  
 / / p a r s e D a t e (   d a t e _ s t r i n g   [ ,   p r e f e r _ e u r o _ f o r m a t ]   )  
 / /  
 / /   T h i s   f u n c t i o n   t a k e s   a   d a t e   s t r i n g   a n d   t r i e s   t o   m a t c h   i t   t o   a  
 / /   n u m b e r   o f   p o s s i b l e   d a t e   f o r m a t s   t o   g e t   t h e   v a l u e .   I t   w i l l   t r y   t o  
 / /   m a t c h   a g a i n s t   t h e   f o l l o w i n g   i n t e r n a t i o n a l   f o r m a t s ,   i n   t h i s   o r d e r :  
 / /   y - M - d       M M M   d ,   y       M M M   d , y       y - M M M - d       d - M M M - y     M M M   d  
 / /   M / d / y       M - d - y             M . d . y           M M M - d           M / d             M - d  
 / /   d / M / y       d - M - y             d . M . y           d - M M M           d / M             d - M  
 / /   A   s e c o n d   a r g u m e n t   m a y   b e   p a s s e d   t o   i n s t r u c t   t h e   m e t h o d   t o   s e a r c h  
 / /   f o r   f o r m a t s   l i k e   d / M / y   ( e u r o p e a n   f o r m a t )   b e f o r e   M / d / y   ( A m e r i c a n ) .  
 / /   R e t u r n s   a   D a t e   o b j e c t   o r   n u l l   i f   n o   p a t t e r n s   m a t c h .  
 / /   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
 f u n c t i o n   p a r s e D a t e ( v a l )   {  
 	 v a r   p r e f e r E u r o = ( a r g u m e n t s . l e n g t h = = 2 ) ? a r g u m e n t s [ 1 ] : f a l s e ;  
 	 / / g e n e r a l F o r m a t s = n e w   A r r a y ( ' y - M - d ' , ' M M M   d ,   y ' , ' M M M   d , y ' , ' y - M M M - d ' , ' d - M M M - y ' , ' M M M   d ' ) ;  
 	 / / g e n e r a l F o r m a t s = n e w   A r r a y ( ' M M / d d / y y y y   H H : m m ' , ' M M / d d / y y   H H : m m ' , ' d d - M M M - y y y y   H H : m m ' , ' y y y y - M M - d d   H H : m m ' ) ;  
 	 g e n e r a l F o r m a t s = n e w   A r r a y ( ' M M / d d / y y y y   H H : m m ' , ' M M / d d / y y   H H : m m ' , ' d d - M M M - y y y y   H H : m m ' , ' y y y y - M M - d d   H H : m m ' ,   ' d d - M M - y y y y   H H : m m ' ,   ' d d - M M - y y   H H : m m ' ) ;  
     m o n t h F i r s t = n e w   A r r a y ( ' M / d / y ' , ' M - d - y ' , ' M . d . y ' , ' M M M - d ' , ' M / d ' , ' M - d ' ) ;  
 	 d a t e F i r s t   = n e w   A r r a y ( ' d / M / y ' , ' d - M - y ' , ' d . M . y ' , ' d - M M M ' , ' d / M ' , ' d - M ' ) ;  
 	 v a r   c h e c k L i s t = n e w   A r r a y ( ' g e n e r a l F o r m a t s ' , p r e f e r E u r o ? ' d a t e F i r s t ' : ' m o n t h F i r s t ' , p r e f e r E u r o ? ' m o n t h F i r s t ' : ' d a t e F i r s t ' ) ;  
 	 / / v a r   c h e c k L i s t = n e w   A r r a y ( ' M M / d d / y y y y   H H : m m ' , ' M M / d d / y y   H H : m m ' , ' d d - M M M - y y y y   H H : m m ' , ' y y y y - M M - d d   H H : m m ' ) ;  
 	 v a r   d = n u l l ;  
 	 f o r   ( v a r   i = 0 ;   i < c h e c k L i s t . l e n g t h ;   i + + )   {  
 	 	 v a r   l = w i n d o w [ c h e c k L i s t [ i ] ] ;  
 	 	 f o r   ( v a r   j = 0 ;   j < l . l e n g t h ;   j + + )   {  
 	 	 	 d = g e t D a t e F r o m F o r m a t ( v a l , l [ j ] ) ;  
 	 	 	 i f   ( d ! = 0 )   {    
 	 	 	 r e t u r n   n e w   D a t e ( d ) ;   }  
 	 	 	 }  
 	 	 }  
 	 r e t u r n   n u l l ;  
 	 }  
  
 	  
 f u n c t i o n   g e t D a t e F o r m a t ( v a l )   {  
 	 v a r   p r e f e r E u r o = ( a r g u m e n t s . l e n g t h = = 2 ) ? a r g u m e n t s [ 1 ] : f a l s e ;  
 	 / / g e n e r a l F o r m a t s = n e w   A r r a y ( ' y - M - d ' , ' M M M   d ,   y ' , ' M M M   d , y ' , ' y - M M M - d ' , ' d - M M M - y ' , ' M M M   d ' ) ;  
 / / 	 g e n e r a l F o r m a t s = n e w   A r r a y ( ' M M / d d / y y y y   H H : m m ' , ' M M / d d / y y   H H : m m ' , ' d d - M M M - y y y y   H H : m m ' , ' y y y y - M M - d d   H H : m m ' ) ;  
 	 g e n e r a l F o r m a t s = n e w   A r r a y ( ' M M / d d / y y y y   H H : m m ' , ' M M / d d / y y   H H : m m ' , ' d d - M M M - y y y y   H H : m m ' , ' y y y y - M M - d d   H H : m m ' ,   ' d d - M M - y y y y   H H : m m ' ,   ' d d - M M - y y   H H : m m ' ) ;  
     m o n t h F i r s t = n e w   A r r a y ( ' M / d / y ' , ' M - d - y ' , ' M . d . y ' , ' M M M - d ' , ' M / d ' , ' M - d ' ) ;  
 	 d a t e F i r s t   = n e w   A r r a y ( ' d / M / y ' , ' d - M - y ' , ' d . M . y ' , ' d - M M M ' , ' d / M ' , ' d - M ' ) ;  
 	 v a r   c h e c k L i s t = n e w   A r r a y ( ' g e n e r a l F o r m a t s ' , p r e f e r E u r o ? ' d a t e F i r s t ' : ' m o n t h F i r s t ' , p r e f e r E u r o ? ' m o n t h F i r s t ' : ' d a t e F i r s t ' ) ;  
 	 / / v a r   c h e c k L i s t = n e w   A r r a y ( ' M M / d d / y y y y   H H : m m ' , ' M M / d d / y y   H H : m m ' , ' d d - M M M - y y y y   H H : m m ' , ' y y y y - M M - d d   H H : m m ' ) ;  
 	 v a r   d = n u l l ;  
 	 f o r   ( v a r   i = 0 ;   i < c h e c k L i s t . l e n g t h ;   i + + )   {  
 	 	 v a r   l = w i n d o w [ c h e c k L i s t [ i ] ] ;  
 	 	 f o r   ( v a r   j = 0 ;   j < l . l e n g t h ;   j + + )   {  
 	 	 	 d = g e t D a t e F r o m F o r m a t ( v a l , l [ j ] ) ;  
 	 	 	 i f   ( d ! = 0 )   {    
 	 	 	 / / a l e r t ( ' d a t e   f o r m a t :   '   +   l [ j ] ) ;  
 	 	 	 r e t u r n   l [ j ] ;   }  
 	 	 	 }  
 	 	 }  
 	 r e t u r n   n u l l ;  
 	 } 	  
  
                                 f u n c t i o n   d i s a b l e B u t t o n ( b u t t o n I D )  
                                 {  
                                     v a r   v a l i d a t e d   =   _ v a l i d a t e F o r m ( d o c u m e n t . f o r m s [ ' f o r m 0 ' ] ) ;  
                                     i f   ( v a l i d a t e d )   {  
                                         v a r   b u t t o n E l e m e n t   =   d o c u m e n t . g e t E l e m e n t B y I d ( b u t t o n I D ) ;  
                                         i f   ( b u t t o n E l e m e n t . d i s a b l e d )   {  
 / / a l e r t ( ' Y o u   c a n   c l i c k   b u t t o n   o n l y   o n c e . ' ) ;  
                                             r e t u r n   f a l s e ;  
                                         }   e l s e   {  
 / / a l e r t ( ' b u t t o n   i s   a c t i v e . ' ) ;  
                                             b u t t o n E l e m e n t . d i s a b l e d   =   t r u e ;  
                                             r e t u r n   t r u e ;  
                                         }  
                                     }   e l s e   {  
                                         r e t u r n   f a l s e ;  
                                     }  
                                 }                    
                          
                 f u n c t i o n   d o L o a d ( )  
                 {  
                         s e t T i m e o u t (   " l o c a t i o n . r e l o a d ( t r u e ) ; " ,   5 0 0 * 1 0 0 0   ) ;     / /   5   m i n u t e s  
                 }  
  
  
                  
                 f u n c t i o n   s h o w _ h i d e ( c o m p n e n t I D )  
                 {  
                     s t a t e   =   d o c u m e n t . g e t E l e m e n t B y I d ( c o m p n e n t I D ) . s t y l e . v i s i b i l i t y ; 	 	 	  
 / / a l e r t (   " C o m p o n e n t [ "   +       c o m p n e n t I D   +   " ]   c u r r e n t   s t a t e   =   [ "   +   s t a t e ) ;  
                  
                     i f   ( s t a t e   = =   " h i d d e n " )   { d o c u m e n t . g e t E l e m e n t B y I d ( c o m p n e n t I D ) . s t y l e . v i s i b i l i t y   =   " v i s i b l e " ; }  
                     i f   ( s t a t e   = =   " v i s i b l e " )   { d o c u m e n t . g e t E l e m e n t B y I d ( c o m p n e n t I D ) . s t y l e . v i s i b i l i t y   =   " h i d d e n " ; }  
                      
                     r e t u r n   t r u e ;  
                 }  
                  
                  
                 f u n c t i o n   s h o w ( o b j e c t )   {  
 / / a l e r t ( " S h o w i n g   [ "   +   o b j e c t ) ;  
                  
                     / / d o c u m e n t . g e t E l e m e n t B y I d ( o b j e c t ) . s t y l e . d i s p l a y   =   " n o n e " ;     / /   f o r   c e r t a i n   b r o w s e r s ? ?  
                     i f   ( d o c u m e n t . g e t E l e m e n t B y I d )   {  
                         d o c u m e n t . g e t E l e m e n t B y I d ( o b j e c t ) . s t y l e . v i s i b i l i t y   =   ' v i s i b l e ' ;  
                     }  
                     e l s e   i f   ( d o c u m e n t . l a y e r s   & &   d o c u m e n t . l a y e r s [ o b j e c t ] )   {  
                         d o c u m e n t . l a y e r s [ o b j e c t ] . v i s i b i l i t y   =   ' v i s i b l e ' ;  
                     }  
                     e l s e   i f   ( d o c u m e n t . a l l )   {  
                         d o c u m e n t . a l l [ o b j e c t ] . s t y l e . v i s i b i l i t y   =   ' v i s i b l e ' ;  
                     }  
                      
                     r e t u r n   t r u e ;  
                 }  
                  
                 f u n c t i o n   h i d e ( o b j e c t )   {  
                  
 / / a l e r t ( " H i d i n g   [ "   +   o b j e c t ) ;  
                     / / d o c u m e n t . g e t E l e m e n t B y I d ( o b j e c t ) . s t y l e . d i s p l a y   =   " b l o c k " ;   / /   f o r   c e r t a i n   b r o w s e r s ? ?  
                     i f   ( d o c u m e n t . g e t E l e m e n t B y I d )   {  
                         d o c u m e n t . g e t E l e m e n t B y I d ( o b j e c t ) . s t y l e . v i s i b i l i t y   =   ' h i d d e n ' ;  
                     }  
                     e l s e   i f   ( d o c u m e n t . l a y e r s   & &   d o c u m e n t . l a y e r s [ o b j e c t ] )   {  
                         d o c u m e n t . l a y e r s [ o b j e c t ] . v i s i b i l i t y   =   ' h i d d e n ' ;  
                     }  
                     e l s e   i f   ( d o c u m e n t . a l l )   {  
                         d o c u m e n t . a l l [ o b j e c t ] . s t y l e . v i s i b i l i t y   =   ' h i d d e n ' ;  
                     }  
                      
                     r e t u r n   t r u e ;  
                 }     5       https://itasm.oraclecorp.com/itas/script/calendar.js     uŠ      uŠ                           ‚    ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚	   ‚
   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚   ‚    ‚!   ‚"   ‚#   ‚$   ‚%   ‚&   ‚'   Ö   š   A=   =   =   =   =   =   =	   =
   =   =   =   =   =   =   =   =   =   =   =   =   =   =   =   =   ,  R ›   QÖ    š   A=   =   =   =   =   =   =    =!   ="   =#   =$   =%   =&   ='   ,  R ›    Q™öÿÿÿ§€ RÿÿÉÉ˜ÿÖ
É € Ê
    DAY_NAMES   MONTH_NAMES   Array   January   February   March   April   May	   June	   July   August   September   October   November   December   Jan   Feb   Mar   Apr   Jun   Jul   Aug   Sep   Oct   Nov   Dec   Sunday   Monday   Tuesday   Wednesday   Thursday   Friday   Saturday   Sun   Mon   Tue   Wed   Thu   Fri   Sat‡!«!ÿÿÿÿ*      openFileUpload   openDisplayClob   _isInteger   doLoad	   show   isDate   msgTextCounter#   getDateFromFormat%   openSchedulerPopup   show_hide   textCounter   getDateFormat   cmSelect   select   formatDate   compareDates   selectShift%   checkConstantValue   openCalPopup3   hmcalendarpopup   refreshPageA   openSchedulerPopupWithDResources   openCalPopup2   enableAllFields   getURLParam   disableButton   displayTT   LZ	   hide9   openSchedulerPopupWithObject!   displayRecordSet   getLFCRDiff'   getValidationErrors   openCalPopup#   returnEventCreate   openLovTable   parseDate   valCheckBox   trimDate   _getInt   DAY_NAMES   MONTH_NAMES(   *   *   «+’H!«!          displayTT                        Ê5ž!«!       !   displayRecordSet °  Â  —  Â  	             Ê5ž!«!          enableAllFields ã  \  Ë  \        p       Ê5ž!«!          valCheckBox }    i    /      p       Ê5ž!«!          hmcalendarpopup 7        S      0       Ê5ž!«!       A   openSchedulerPopupWithDResources s  U  J  U  o   )          Ê5ž!«!       %   openSchedulerPopup ¯  )  ”  )  {             Ê5ž!«!       9   openSchedulerPopupWithObject   )  h  )  ‡   %          Ê5ž!«!          openCalPopup b  š  M  š  •             Ê5ž!«!          selectShift ²  ©  ž  ©  Ÿ      P       Ê5ž!«!          select Ú  ½)  Ë  ½)  Þ      `       Ê5ž!«!          openCalPopup2 Ù)  õ*  Ã)  õ*  3            Ê5ž!«!          openCalPopup3 +  ›,  ù*  ›,  <            Ê5ž!«!          openLovTable ´,  &.  Ÿ,  &.  F            Ê5ž!«!          refreshPage  @.  Q/  ,.  Q/  Q            Ê5ž!«!          cmSelect j/  ž1  Y/  ž1  Z            Ê5ž!«!          openFileUpload Ù1  A3  Â1  A3  k            Ê5ž!«!          openDisplayClob }3  ‹4  e3  ‹4  u            Ê5ž!«!       #   returnEventCreate  5  a:  è4  a:       0       Ê5ž!«!          getURLParam y:  ¡<  e:  ¡<  §     @       Ê5ž!«!       '   getValidationErrors Á<  ­=  ¥<  ­=  ¸            Ê5ž!«!          textCounter Å=  e@  ±=  e@  ¾     0       Ê5ž!«!          msgTextCounter €@  D  i@  D  Ï     0       Ê5ž!«!          getLFCRDiff D  JF  	D  JF  ã     `       Ê5ž!«!       %   checkConstantValue  iF  >H  NF  >H                Ê5ž!«!          trimDate SH  ïH  BH  ïH              Ê5ž!«!          LZ ¾U  ÝU  ³U  ÝU  T            Ê5ž!«!          isDate ›W  X  ŒW  X  ]             Ê5ž!«!          compareDates ÊY  ²Z  µY  ²Z  k     0       Ê5ž!«!          formatDate û[  Îa  è[  Îa  |     Ð       Ê5ž!«!          _isInteger ­b  Jc  šb  Jc  ·     0       Ê5ž!«!          _getInt \c  ?d  Lc  ?d  ¾     @       Ê5ž!«!       #   getDateFromFormat ìe  :u  Òe  :u  Î     P      Ê5ž!«!          parseDate ›x  ~|  ‰x  ~|  Y     A       Ê5ž!«!          getDateFormat ›|  œ€  …|  œ€  o     A       Ê5ž!«!          disableButton Ç€  9ƒ  ±€  9ƒ  …  &   P       Ê5ž!«!          doLoad  iƒ  Îƒ  Zƒ  Îƒ  —            Ê5ž!«!          show_hide øƒ  ¨…  æƒ  ¨…  ž     0       Ê5ž!«!       	   show Ó…  ˆ  Æ…  ˆ  ª     @       Ê5ž!«!       	   hide 6ˆ  tŠ  )ˆ  tŠ  »     @       Ê5žš˜;øùà©–ó      ]÷Â]÷ÂA$p^ öz   5    :https://itasm.oraclecorp.com/itas/script/calendar.js necko:classified 1 strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAQAAgAAAAAAAAAAAAAAAAAAAAAB4vFIJp5wRkeyPxAQ9RJGKPqbqVvKO0mKuIl8ec8o/uhmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAZXMIIGUzCCBTugAwIBAgIQA0SkBkcJHfOfYEyXPo7YCjANBgkqhkiG9w0BAQsFADBNMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMScwJQYDVQQDEx5EaWdpQ2VydCBTSEEyIFNlY3VyZSBTZXJ2ZXIgQ0EwHhcNMTkwMzExMDAwMDAwWhcNMjAwNTA5MTIwMDAwWjCBjTELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFTATBgNVBAcTDFJlZHdvb2QgQ2l0eTEbMBkGA1UEChMST3JhY2xlIENvcnBvcmF0aW9uMRowGAYDVQQLExFPcmFjbGUgR0lULUVOUyBVUzEZMBcGA1UEAwwQKi5vcmFjbGVjb3JwLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAI3Wh/dT0vDahFEPaDRtW9ZT06dqYHsKLyrl5IxXTt+6xgeihqsBRjDRa8P0mzgyl8YHSivUAeYiNXMXSyOaueCSRPWpTyg/K4eKuHhJdKo/7CnFVz+LrmVt7YSf7duQDXJt6Lm2wwh36+uj7qeYAb8vEfUp5MiF8p6brVK+flMTiFOL98xeye3NkN8SrShwE5fEiEpdpoCisiHtMN86zJ+U9rDaQrh4Y1Zcclaj/waw6bWAdoT3bLy+AZLMi3tdBpvDDRvsjgP5uVNGtgdLSQBFxeBeQGwyAZwxyHkC2ya/oI/w0RloiMweRcXN8PqEMaZ5EpaX5TVg1LFuTTtuhe8CAwEAAaOCAuwwggLoMB8GA1UdIwQYMBaAFA+AYRyCMWHVLyjnjUY4tCzhxtniMB0GA1UdDgQWBBRde0AeCaEcgi7KnzjK5q/ZuybqBTArBgNVHREEJDAighAqLm9yYWNsZWNvcnAuY29tgg5vcmFjbGVjb3JwLmNvbTAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMGsGA1UdHwRkMGIwL6AtoCuGKWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9zc2NhLXNoYTItZzYuY3JsMC+gLaArhilodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vc3NjYS1zaGEyLWc2LmNybDBMBgNVHSAERTBDMDcGCWCGSAGG/WwBATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5jb20vQ1BTMAgGBmeBDAECAjB8BggrBgEFBQcBAQRwMG4wJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBGBggrBgEFBQcwAoY6aHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0U0hBMlNlY3VyZVNlcnZlckNBLmNydDAJBgNVHRMEAjAAMIIBBAYKKwYBBAHWeQIEAgSB9QSB8gDwAHcAu9nfvB+KcbWTlCOXqpJ7RzhXlQqrUugakJZkNo4e0YUAAAFpbrOPSwAABAMASDBGAiEAvu40L2p0w35ylTAGNxDS7cUqD8MjdrBa/zl9SVFTgBQCIQCsHx51KQsLUbnpesUwy7/FetQcumtU2vUfdgz06DNkXgB1AId1v+dZfPiMQ5lfvfNu/1aNR1Y2/0q1YMG06v9eoIMPAAABaW6zkJIAAAQDAEYwRAIgXnTtAQEXnqAEWCEsjZZAcvS26zisCfG/py8UjBxM4FoCIGHAnCYYNAYAKhxBVDdtMhZV5wKsMl/cCpZDw/uKZ9plMA0GCSqGSIb3DQEBCwUAA4IBAQA5xgV+7SUXK3WKVqsdF3Cw8vk3tWLHNmIjGukW4s/FuZvEudpIRycZmnuB1nAz3Fy6pjyLjJtLz5xso58tm/YIgVys3tV6Lwyv7WXh7X4laPpwxm6aw5UaN2D+UGFHjQnc9lsyWmQXkmC/TafJZFxtP7RYiHfSsOOG2fVS8XPKuYZCziVZxSHu/P+Vt9JgA84d2rd6XtdfMYHCY3JVHYZlNLwD9xnHhBqlXhhbeh0CPMxjL/v1ec0zj6jWIiHGEaG8ubtDyqb+bRubcYmiYm+iQux1xCyodfffsG8sdj115DVMEIv0aY+c09wzttfV9bro7/PVErmaBQoh+j70+9WVADkDAwAAAAABAQAAAAAAAARub25lAAAAEFJTQS1QS0NTMS1TSEEyNTYAAAA= request-method GET response-head HTTP/1.1 200 OK
Last-Modified: Wed, 22 Jun 2016 03:58:12 GMT
Accept-Ranges: bytes
Content-Length: 35445
Content-Type: application/octet-stream
Date: Mon, 16 Dec 2019 17:16:43 GMT
Server: Oracle-Application-Server-10g/10.1.2.0.2 Oracle-HTTP-Server
Cache-Control: private
 original-response-headers Date: Mon, 09 Dec 2019 00:35:30 GMT
Server: Oracle-Application-Server-10g/10.1.2.0.2 Oracle-HTTP-Server
Last-Modified: Wed, 22 Jun 2016 03:58:12 GMT
Accept-Ranges: bytes
Content-Length: 35445
Cache-Control: private
Keep-Alive: timeout=60, max=200
Connection: Keep-Alive
Content-Type: application/octet-stream
Set-Cookie: BIGipServeritasm-prod_pool=401429644.20480.0000; expires=Mon, 09-Dec-2019 08:35:30 GMT; path=/; Httponly; Secure
 net-response-time-onstart 4610 net-response-time-onstop 8319 alt-data 1;35445,javascript/moz-bytecode-20181008124021 alt-data-from-child 1  ±Ï